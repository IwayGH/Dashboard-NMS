<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Microwave NMS - Network Management System</title>

    <!-- Meta Tags for SEO -->
    <meta
      name="description"
      content="Microwave Network Management System with 3D Globe Visualization"
    />
    <meta name="author" content="Network Team" />

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“¡</text></svg>"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome for Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- CesiumJS -->
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.105/Build/Cesium/Cesium.js"></script>
    <link
      href="https://cesium.com/downloads/cesiumjs/releases/1.105/Build/Cesium/Widgets/widgets.css"
      rel="stylesheet"
    />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Alpine.js for Interactivity -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <!-- SheetJS for Excel export/import -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Custom Tailwind Config -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: {
                50: "#eff6ff",
                100: "#dbeafe",
                200: "#bfdbfe",
                300: "#93c5fd",
                400: "#60a5fa",
                500: "#3b82f6",
                600: "#2563eb",
                700: "#1d4ed8",
                800: "#1e40af",
                900: "#1e3a8a",
              },
            },
            fontFamily: {
              sans: ["Inter", "sans-serif"],
              mono: ["JetBrains Mono", "monospace"],
            },
            animation: {
              "fade-in": "fadeIn 0.5s ease-in-out",
              "slide-up": "slideUp 0.3s ease-out",
              "pulse-slow": "pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            },
            keyframes: {
              fadeIn: {
                "0%": { opacity: "0" },
                "100%": { opacity: "1" },
              },
              slideUp: {
                "0%": { transform: "translateY(10px)", opacity: "0" },
                "100%": { transform: "translateY(0)", opacity: "1" },
              },
            },
          },
        },
      };
    </script>

    <!-- Custom CSS -->
    <style>
      :root {
        --sidebar-width: 260px;
      }

      body {
        font-family: "Inter", sans-serif;
      }

      .sidebar {
        width: var(--sidebar-width);
        transition: all 0.3s ease;
      }

      .sidebar.collapsed {
        width: 70px;
      }

      .main-content {
        margin-left: var(--sidebar-width);
        transition: all 0.3s ease;
      }

      .main-content.expanded {
        margin-left: 70px;
      }

      .metric-card {
        transition: all 0.3s ease;
      }

      .metric-card:hover {
        transform: translateY(-5px);
      }

      .notification {
        animation: slideUp 0.3s ease-out;
      }

      .map-container {
        height: 500px;
      }

      .loading-spinner {
        border-top-color: #3b82f6;
        animation: spinner 1s linear infinite;
      }

      @keyframes spinner {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .cesium-viewer-bottom {
        display: none;
      }

      .chart-container {
        position: relative;
        height: 250px;
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      .dark ::-webkit-scrollbar-track {
        background: #1f2937;
      }

      .dark ::-webkit-scrollbar-thumb {
        background: #4b5563;
      }

      .dark ::-webkit-scrollbar-thumb:hover {
        background: #6b7280;
      }

      [x-cloak] {
        display: none !important;
      }

      /* Login Styles */
      .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #1e3a8a 0%, #1d4ed8 100%);
      }

      .login-card {
        width: 100%;
        max-width: 420px;
        background-color: white;
        border-radius: 1rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
        overflow: hidden;
      }

      .login-header {
        background-color: #1e40af;
        color: white;
        padding: 2rem;
        text-align: center;
      }

      .login-body {
        padding: 2rem;
      }

      .form-input {
        transition: all 0.3s ease;
      }

      .form-input:focus {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      .login-btn {
        transition: all 0.3s ease;
      }

      .login-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
    </style>
  </head>

  <body
    class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100"
    x-data="{ 
    // Login state
    isLoggedIn: sessionStorage.getItem('isLoggedIn') === 'true',
    username: '',
    password: '',
    rememberMe: false,
    showError: false,
    errorMessage: '',
    
    // App state
    darkMode: localStorage.getItem('darkMode') === 'true', 
    sidebarCollapsed: localStorage.getItem('sidebarCollapsed') === 'true',
    notifications: [],
    currentView: 'dashboard',
    showProfile: false,
    showSettings: false,
    showUserManagement: false,
    showPermissionRequests: false,
    showAuditLog: false,
    selectedUser: null,
    showUserPermissions: false,
    
    // Sites data and functions
    sites: [
        { id: 'JKT-01', name: 'Jakarta Central', location: '-6.2088, 106.8456', status: 'Online', links: 4, lastUpdate: '2 min ago' },
        { id: 'BDG-01', name: 'Bandung Utara', location: '-6.9175, 107.6191', status: 'Offline', links: 3, lastUpdate: '2 hours ago' },
        { id: 'SMG-01', name: 'Semarang Timur', location: '-6.9667, 110.4167', status: 'Online', links: 2, lastUpdate: '5 min ago' },
        { id: 'SBY-01', name: 'Surabaya Barat', location: '-7.2575, 112.7521', status: 'Warning', links: 5, lastUpdate: '15 min ago' }
    ],
    showAddSiteModal: false,
    newSite: { id: '', name: '', location: '', status: 'Online', links: 0, lastUpdate: 'Just now' },
    siteFilter: { status: '', location: '' },
    
    // Links data and functions
    links: [
        { id: 1, name: 'JKT-01 to BDG-01', frequency: '15 GHz', distance: '120 km', capacity: '1 Gbps', rsl: '-35 dBm', utilization: '45%', status: 'Online', lastUpdate: '2 min ago' },
        { id: 2, name: 'BDG-01 to SMG-01', frequency: '18 GHz', distance: '260 km', capacity: '2 Gbps', rsl: '-- dBm', utilization: '--', status: 'Offline', lastUpdate: '2 hours ago' },
        { id: 3, name: 'SMG-01 to SBY-01', frequency: '23 GHz', distance: '320 km', capacity: '1 Gbps', rsl: '-42 dBm', utilization: '78%', status: 'Warning', lastUpdate: '15 min ago' }
    ],
    showAddLinkModal: false,
    newLink: { name: '', frequency: '', distance: '', capacity: '', rsl: '', utilization: '', status: 'Online', lastUpdate: 'Just now' },
    linkFilter: { status: '' },
    
    // Reports data and functions
    reports: {
        recent: [
            { id: 1, name: 'Monthly Performance', type: 'Performance Summary', date: 'Oct 1, 2023', format: 'PDF' },
            { id: 2, name: 'Link Utilization Q3', type: 'Link Utilization', date: 'Sep 30, 2023', format: 'Excel' },
            { id: 3, name: 'Availability Report', type: 'Availability Report', date: 'Sep 15, 2023', format: 'PDF' }
        ],
        scheduled: [
            { id: 1, name: 'Weekly Performance', type: 'Performance Summary', schedule: 'Every Monday', recipients: 'admin@example.com', status: 'Active' },
            { id: 2, name: 'Monthly Utilization', type: 'Link Utilization', schedule: '1st of every month', recipients: 'admin@example.com, team@example.com', status: 'Active' }
        ]
    },
    
    // Settings data and functions
    settings: {
        users: {
            active: true,
            permissions: true
        },
        notifications: {
            email: true,
            push: true
        },
        dataSources: {
            primary: 'SNMP',
            backup: 'API'
        },
        map: {
            defaultView: '3D Globe',
            defaultLocation: { lat: '-6.2088', lng: '106.8456' }
        },
        backup: {
            lastBackup: '2023-10-10 14:30:00',
            autoBackup: true,
            schedule: 'Daily at 02:00 AM'
        }
    },
    
    // User data
    currentUser: {
        id: 1,
        name: sessionStorage.getItem('username') || 'Admin User',
        email: (sessionStorage.getItem('username') || 'admin') + '@example.com',
        role: sessionStorage.getItem('userRole') || 'administrator', // administrator, operator, viewer
        permissions: [], // Akan diisi berdasarkan role
        avatar: null,
        lastLogin: new Date().toISOString(),
        sessionTimeout: 30 // minutes
    },
    
    // Role definitions
    roles: {
        administrator: {
            name: 'Administrator',
            permissions: [
                'users.read', 'users.create', 'users.update', 'users.delete',
                'sites.read', 'sites.create', 'sites.update', 'sites.delete',
                'links.read', 'links.create', 'links.update', 'links.delete',
                'alerts.read', 'alerts.acknowledge', 'alerts.create',
                'reports.read', 'reports.create', 'reports.delete',
                'settings.read', 'settings.update',
                'system.backup', 'system.restore', 'system.audit'
            ],
            color: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'
        },
        operator: {
            name: 'Operator',
            permissions: [
                'sites.read', 'sites.update',
                'links.read', 'links.update',
                'alerts.read', 'alerts.acknowledge',
                'reports.read', 'reports.create'
            ],
            color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400'
        },
        viewer: {
            name: 'Viewer',
            permissions: [
                'sites.read',
                'links.read',
                'alerts.read',
                'reports.read'
            ],
            color: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400'
        }
    },
    
    // Permission requests
    permissionRequests: [
        {
            id: 1,
            userId: 2,
            userName: 'Operator User',
            userRole: 'operator',
            requestedPermission: 'sites.create',
            reason: 'Need to add new sites for expansion project',
            status: 'pending', // pending, approved, rejected
            requestedAt: '2023-10-15T10:30:00',
            reviewedBy: null,
            reviewedAt: null
        },
        {
            id: 2,
            userId: 3,
            userName: 'Viewer User',
            userRole: 'viewer',
            requestedPermission: 'alerts.acknowledge',
            reason: 'Need to acknowledge alerts during night shift',
            status: 'approved',
            requestedAt: '2023-10-14T14:20:00',
            reviewedBy: 'Admin User',
            reviewedAt: '2023-10-14T15:45:00'
        }
    ],
    
    // Users list
    users: [
        {
            id: 1,
            name: 'Admin User',
            email: 'admin@example.com',
            role: 'administrator',
            status: 'active',
            lastLogin: '2023-10-15T08:30:00',
            sessionExpiry: new Date(Date.now() + 30 * 60000).toISOString()
        },
        {
            id: 2,
            name: 'Operator User',
            email: 'operator@example.com',
            role: 'operator',
            status: 'active',
            lastLogin: '2023-10-15T07:45:00',
            sessionExpiry: new Date(Date.now() + 25 * 60000).toISOString()
        },
        {
            id: 3,
            name: 'Viewer User',
            email: 'viewer@example.com',
            role: 'viewer',
            status: 'active',
            lastLogin: '2023-10-14T16:20:00',
            sessionExpiry: new Date(Date.now() + 20 * 60000).toISOString()
        },
        {
            id: 4,
            name: 'Tech Support',
            email: 'tech@example.com',
            role: 'operator',
            status: 'inactive',
            lastLogin: '2023-10-10T11:15:00',
            sessionExpiry: null
        }
    ],
    
    // Audit log
    auditLog: [
        {
            id: 1,
            userId: 1,
            userName: 'Admin User',
            action: 'CREATE_USER',
            target: 'Operator User',
            details: 'Created new user with operator role',
            timestamp: '2023-10-15T09:15:00',
            ipAddress: '192.168.1.100'
        },
        {
            id: 2,
            userId: 2,
            userName: 'Operator User',
            action: 'UPDATE_SITE',
            target: 'JKT-01',
            details: 'Updated site configuration',
            timestamp: '2023-10-15T08:45:00',
            ipAddress: '192.168.1.101'
        },
        {
            id: 3,
            userId: 1,
            userName: 'Admin User',
            action: 'APPROVE_PERMISSION',
            target: 'alerts.acknowledge',
            details: 'Approved permission request for Viewer User',
            timestamp: '2023-10-14T15:45:00',
            ipAddress: '192.168.1.100'
        }
    ],
    
    // Session timer
    sessionTimer: null,
    sessionTimeLeft: 30,
    
    // Methods
    hasPermission(permission) {
        if (this.currentUser.role === 'administrator') return true;
        return this.currentUser.permissions.includes(permission);
    },
    
    showNotification(message, type = 'info') {
        this.notifications.push({ id: Date.now(), message, type });
        setTimeout(() => {
            this.notifications = this.notifications.filter(n => n.id !== this.notifications[0].id);
        }, 3000);
    },
    
    toggleDarkMode() {
        this.darkMode = !this.darkMode;
        localStorage.setItem('darkMode', this.darkMode);
        if (this.darkMode) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    },
    
    toggleSidebar() {
        this.sidebarCollapsed = !this.sidebarCollapsed;
        localStorage.setItem('sidebarCollapsed', this.sidebarCollapsed);
    },
    
    navigate(view) {
        this.currentView = view;
    },
    
    // Sites functions
    addSite() {
        if (!this.newSite.id || !this.newSite.name || !this.newSite.location) {
            this.showNotification('Please fill all required fields', 'error');
            return;
        }
        
        this.sites.push({...this.newSite});
        this.showAddSiteModal = false;
        this.newSite = { id: '', name: '', location: '', status: 'Online', links: 0, lastUpdate: 'Just now' };
        this.showNotification('Site added successfully!', 'success');
        this.addToAuditLog('CREATE_SITE', this.newSite.id, `Created new site: ${this.newSite.name}`);
    },
    
    exportSites() {
        // Create a workbook
        const wb = XLSX.utils.book_new();
        
        // Create worksheet data
        const wsData = [
            ['Site ID', 'Name', 'Location', 'Status', 'Links', 'Last Update']
        ];
        
        // Add site data
        this.sites.forEach(site => {
            wsData.push([site.id, site.name, site.location, site.status, site.links, site.lastUpdate]);
        });
        
        // Create worksheet
        const ws = XLSX.utils.aoa_to_sheet(wsData);
        
        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(wb, ws, 'Sites');
        
        // Save workbook
        XLSX.writeFile(wb, 'network_sites.xlsx');
        
        this.showNotification('Sites data exported successfully!', 'success');
    },
    
    // Links functions
    addLink() {
        if (!this.newLink.name || !this.newLink.frequency || !this.newLink.distance) {
            this.showNotification('Please fill all required fields', 'error');
            return;
        }
        
        this.newLink.id = this.links.length + 1;
        this.links.push({...this.newLink});
        this.showAddLinkModal = false;
        this.newLink = { name: '', frequency: '', distance: '', capacity: '', rsl: '', utilization: '', status: 'Online', lastUpdate: 'Just now' };
        this.showNotification('Link added successfully!', 'success');
        this.addToAuditLog('CREATE_LINK', this.newLink.name, `Created new link: ${this.newLink.name}`);
    },
    
    exportLinks() {
        // Create a workbook
        const wb = XLSX.utils.book_new();
        
        // Create worksheet data
        const wsData = [
            ['Link Name', 'Frequency', 'Distance', 'Capacity', 'RSL', 'Utilization', 'Status', 'Last Update']
        ];
        
        // Add link data
        this.links.forEach(link => {
            wsData.push([link.name, link.frequency, link.distance, link.capacity, link.rsl, link.utilization, link.status, link.lastUpdate]);
        });
        
        // Create worksheet
        const ws = XLSX.utils.aoa_to_sheet(wsData);
        
        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(wb, ws, 'Links');
        
        // Save workbook
        XLSX.writeFile(wb, 'network_links.xlsx');
        
        this.showNotification('Links data exported successfully!', 'success');
    },
    
    uploadLinks(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                
                // Skip header row and process data
                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    if (row.length >= 3) { // Ensure there's enough data
                        this.links.push({
                            id: this.links.length + 1,
                            name: row[0] || '',
                            frequency: row[1] || '',
                            distance: row[2] || '',
                            capacity: row[3] || '',
                            rsl: row[4] || '',
                            utilization: row[5] || '',
                            status: row[6] || 'Online',
                            lastUpdate: 'Just now'
                        });
                    }
                }
                
                this.showNotification('Links data imported successfully!', 'success');
                this.addToAuditLog('IMPORT_LINKS', 'Excel File', `Imported ${jsonData.length - 1} links from Excel file`);
            } catch (error) {
                this.showNotification('Error importing file: ' + error.message, 'error');
            }
        };
        reader.readAsArrayBuffer(file);
    },
    
    // Reports functions
    downloadReport(reportId) {
        const report = this.reports.recent.find(r => r.id === reportId);
        if (report) {
            // Simulate download
            this.showNotification(`Downloading ${report.name}...`, 'info');
            setTimeout(() => {
                this.showNotification(`${report.name} downloaded successfully!`, 'success');
            }, 1500);
        }
    },
    
    deleteReport(reportId) {
        const index = this.reports.recent.findIndex(r => r.id === reportId);
        if (index !== -1) {
            const report = this.reports.recent[index];
            this.reports.recent.splice(index, 1);
            this.showNotification('Report deleted successfully!', 'success');
            this.addToAuditLog('DELETE_REPORT', report.name, `Deleted report: ${report.name}`);
        }
    },
    
    editScheduledReport(reportId) {
        this.showNotification('Edit scheduled report functionality would open a form here', 'info');
    },
    
    deleteScheduledReport(reportId) {
        const index = this.reports.scheduled.findIndex(r => r.id === reportId);
        if (index !== -1) {
            const report = this.reports.scheduled[index];
            this.reports.scheduled.splice(index, 1);
            this.showNotification('Scheduled report deleted successfully!', 'success');
            this.addToAuditLog('DELETE_SCHEDULED_REPORT', report.name, `Deleted scheduled report: ${report.name}`);
        }
    },
    
    // Settings functions
    toggleUsersPermissions() {
        this.settings.users.active = !this.settings.users.active;
        this.showNotification(`Users & Permissions ${this.settings.users.active ? 'enabled' : 'disabled'}!`, 'success');
    },
    
    toggleNotifications() {
        this.settings.notifications.email = !this.settings.notifications.email;
        this.settings.notifications.push = !this.settings.notifications.push;
        this.showNotification(`Notifications ${this.settings.notifications.email ? 'enabled' : 'disabled'}!`, 'success');
    },
    
    updateDataSources(source) {
        this.settings.dataSources.primary = source;
        this.showNotification(`Primary data source updated to ${source}!`, 'success');
    },
    
    updateMapSettings(setting, value) {
        this.settings.map[setting] = value;
        this.showNotification(`Map setting ${setting} updated!`, 'success');
    },
    
    performBackup() {
        this.showNotification('Backup process started...', 'info');
        setTimeout(() => {
            this.settings.backup.lastBackup = new Date().toISOString();
            this.showNotification('Backup completed successfully!', 'success');
            this.addToAuditLog('SYSTEM_BACKUP', 'System', 'System backup completed');
        }, 2000);
    },
    
    restoreBackup() {
        if (confirm('Are you sure you want to restore from backup? This will overwrite current data.')) {
            this.showNotification('Restore process started...', 'info');
            setTimeout(() => {
                this.showNotification('System restored successfully!', 'success');
                this.addToAuditLog('SYSTEM_RESTORE', 'System', 'System restored from backup');
            }, 2000);
        }
    },
    
    // User Management functions
    showAddUserModal: false,
    newUser: { name: '', email: '', role: 'viewer', status: 'active' },
    
    addUser() {
        if (!this.newUser.name || !this.newUser.email) {
            this.showNotification('Please fill all required fields', 'error');
            return;
        }
        
        this.newUser.id = this.users.length + 1;
        this.users.push({...this.newUser});
        this.showAddUserModal = false;
        this.newUser = { name: '', email: '', role: 'viewer', status: 'active' };
        this.showNotification('User added successfully!', 'success');
        this.addToAuditLog('CREATE_USER', this.newUser.name, `Created new user: ${this.newUser.name}`);
    },
    
    editUser(userId) {
        const user = this.users.find(u => u.id === userId);
        if (user) {
            this.showNotification(`Edit user: ${user.name}`, 'info');
            // In a real app, this would open an edit modal
        }
    },
    
    deleteUser(userId) {
        if (confirm('Are you sure you want to delete this user?')) {
            const index = this.users.findIndex(u => u.id === userId);
            if (index !== -1) {
                const user = this.users[index];
                this.users.splice(index, 1);
                this.showNotification('User deleted successfully!', 'success');
                this.addToAuditLog('DELETE_USER', user.name, `Deleted user: ${user.name}`);
            }
        }
    },
    
    // Permission Request functions
    activePermissionTab: 'all',
    
    getFilteredPermissionRequests() {
        if (this.activePermissionTab === 'all') {
            return this.permissionRequests;
        } else {
            return this.permissionRequests.filter(req => req.status === this.activePermissionTab);
        }
    },
    
    setPermissionTab(tab) {
        this.activePermissionTab = tab;
    },
    
    // Login methods
    login() {
        // Reset error states
        this.showError = false;
        this.errorMessage = '';
        
        // Simple validation
        if (!this.username) {
            this.errorMessage = 'Username harus diisi';
            this.showError = true;
            return;
        }
        
        if (!this.password) {
            this.errorMessage = 'Password harus diisi';
            this.showError = true;
            return;
        }
        
        // Simple authentication (in real app, this would be an API call)
        const validCredentials = [
            { username: 'admin', password: 'admin123', role: 'administrator' },
            { username: 'operator', password: 'operator123', role: 'operator' },
            { username: 'viewer', password: 'viewer123', role: 'viewer' }
        ];
        
        const user = validCredentials.find(cred => 
            cred.username === this.username && cred.password === this.password
        );
        
        if (user) {
            // Save login state to sessionStorage
            sessionStorage.setItem('isLoggedIn', 'true');
            sessionStorage.setItem('username', user.username);
            sessionStorage.setItem('userRole', user.role);
            
            // Update current user
            this.currentUser.name = user.username;
            this.currentUser.email = user.username + '@example.com';
            this.currentUser.role = user.role;
            this.initUserPermissions();
            
            // Set isLoggedIn to true
            this.isLoggedIn = true;
            
            // Show success notification
            this.showNotification('Login berhasil!', 'success');
        } else {
            // Show error
            this.errorMessage = 'Username atau password salah';
            this.showError = true;
        }
    },
    
    logout() {
        if (confirm('Apakah Anda yakin ingin keluar?')) {
            this.showNotification('Sedang keluar...', 'info');
            // Add to audit log
            this.addToAuditLog('LOGOUT', 'System', 'User logged out');
            // Clear login data
            sessionStorage.removeItem('isLoggedIn');
            sessionStorage.removeItem('username');
            sessionStorage.removeItem('userRole');
            // Set isLoggedIn to false
            this.isLoggedIn = false;
            // Reset current user
            this.currentUser = {
                id: 1,
                name: 'Guest User',
                email: 'guest@example.com',
                role: 'viewer',
                permissions: [],
                avatar: null,
                lastLogin: new Date().toISOString(),
                sessionTimeout: 30
            };
        }
    },
    
    requestPermission(permission, reason) {
        this.showNotification('Permintaan izin telah dikirim ke administrator!', 'success');
        this.permissionRequests.unshift({
            id: Date.now(),
            userId: this.currentUser.id,
            userName: this.currentUser.name,
            userRole: this.currentUser.role,
            requestedPermission: permission,
            reason: reason,
            status: 'pending',
            requestedAt: new Date().toISOString(),
            reviewedBy: null,
            reviewedAt: null
        });
        this.addToAuditLog('REQUEST_PERMISSION', permission, `Requested permission: ${permission}`);
    },
    
    requestAdditionalPermission(permission) {
        this.showNotification('Permintaan izin telah dikirim ke administrator!', 'success');
        this.permissionRequests.unshift({
            id: Date.now(),
            userId: this.currentUser.id,
            userName: this.currentUser.name,
            userRole: this.currentUser.role,
            requestedPermission: permission,
            reason: 'User requested additional access',
            status: 'pending',
            requestedAt: new Date().toISOString(),
            reviewedBy: null,
            reviewedAt: null
        });
        this.addToAuditLog('REQUEST_PERMISSION', permission, `Requested permission: ${permission}`);
    },
    
    approvePermission(requestId) {
        const request = this.permissionRequests.find(r => r.id === requestId);
        if (request) {
            request.status = 'approved';
            request.reviewedBy = this.currentUser.name;
            request.reviewedAt = new Date().toISOString();
            this.showNotification('Izin disetujui!', 'success');
            this.addToAuditLog('APPROVE_PERMISSION', request.requestedPermission, `Approved permission for ${request.userName}`);
        }
    },
    
    rejectPermission(requestId) {
        const request = this.permissionRequests.find(r => r.id === requestId);
        if (request) {
            request.status = 'rejected';
            request.reviewedBy = this.currentUser.name;
            request.reviewedAt = new Date().toISOString();
            this.showNotification('Izin ditolak!', 'info');
            this.addToAuditLog('REJECT_PERMISSION', request.requestedPermission, `Rejected permission for ${request.userName}`);
        }
    },
    
    updateUserRole(userId, newRole) {
        const user = this.users.find(u => u.id === userId);
        if (user) {
            const oldRole = user.role;
            user.role = newRole;
            this.showNotification(`Peran pengguna diperbarui menjadi ${newRole}!`, 'success');
            this.addToAuditLog('UPDATE_USER_ROLE', user.name, `Changed role from ${oldRole} to ${newRole}`);
        }
    },
    
    addToAuditLog(action, target, details) {
        this.auditLog.unshift({
            id: Date.now(),
            userId: this.currentUser.id,
            userName: this.currentUser.name,
            action: action,
            target: target,
            details: details,
            timestamp: new Date().toISOString(),
            ipAddress: '192.168.1.100' // In real app, this would be captured from request
        });
    },
    
    startSessionTimer() {
        this.sessionTimeLeft = this.currentUser.sessionTimeout;
        this.sessionTimer = setInterval(() => {
            this.sessionTimeLeft--;
            if (this.sessionTimeLeft <= 0) {
                clearInterval(this.sessionTimer);
                this.logout();
            }
        }, 60000); // Update every minute
    },
    
    extendSession() {
        this.sessionTimeLeft = this.currentUser.sessionTimeout;
        this.showNotification('Sesi diperpanjang!', 'success');
        this.addToAuditLog('EXTEND_SESSION', 'System', 'User extended session');
    },
    
    initUserPermissions() {
        // Set permissions based on user role
        if (this.currentUser.role === 'administrator') {
            this.currentUser.permissions = this.roles.administrator.permissions;
        } else if (this.currentUser.role === 'operator') {
            this.currentUser.permissions = this.roles.operator.permissions;
        } else if (this.currentUser.role === 'viewer') {
            this.currentUser.permissions = this.roles.viewer.permissions;
        }
    }
}"
    x-init="if (darkMode) { document.documentElement.classList.add('dark'); } 
            if (sessionStorage.getItem('isLoggedIn') === 'true') {
                this.currentUser.name = sessionStorage.getItem('username') || 'Admin User';
                this.currentUser.email = (sessionStorage.getItem('username') || 'admin') + '@example.com';
                this.currentUser.role = sessionStorage.getItem('userRole') || 'administrator';
            }
            initUserPermissions(); 
            startSessionTimer();"
  >
    <!-- Login Page -->
    <div x-show="!isLoggedIn" class="login-container">
      <!-- Notification Container -->
      <div class="fixed top-4 right-4 z-50">
        <template x-for="notification in notifications" :key="notification.id">
          <div
            class="notification p-4 rounded-lg shadow-lg flex items-center"
            :class="{
                           'bg-blue-500 text-white': notification.type === 'info',
                           'bg-green-500 text-white': notification.type === 'success',
                           'bg-yellow-500 text-white': notification.type === 'warning',
                           'bg-red-500 text-white': notification.type === 'error'
                         }"
          >
            <i
              class="fas mr-2"
              :class="{
                             'fa-info-circle': notification.type === 'info',
                             'fa-check-circle': notification.type === 'success',
                             'fa-exclamation-triangle': notification.type === 'warning',
                             'fa-times-circle': notification.type === 'error'
                           }"
            ></i>
            <span x-text="notification.message"></span>
          </div>
        </template>
      </div>

      <div class="login-card">
        <div class="login-header">
          <div class="flex justify-center mb-4">
            <div
              class="w-16 h-16 rounded-lg bg-white flex items-center justify-center"
            >
              <i class="fas fa-globe-americas text-primary-600 text-2xl"></i>
            </div>
          </div>
          <h1 class="text-2xl font-bold">Microwave NMS</h1>
          <p class="text-blue-100 mt-1">Network Management System</p>
        </div>

        <div class="login-body">
          <form @submit.prevent="login()">
            <div class="mb-4">
              <label
                for="login-username"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Username</label
              >
              <div class="relative">
                <div
                  class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
                >
                  <i class="fas fa-user text-gray-400"></i>
                </div>
                <input
                  type="text"
                  id="login-username"
                  x-model="username"
                  class="form-input block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  placeholder="Masukkan username"
                />
              </div>
            </div>

            <div class="mb-4">
              <label
                for="login-password"
                class="block text-sm font-medium text-gray-700 mb-1"
                >Password</label
              >
              <div class="relative">
                <div
                  class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
                >
                  <i class="fas fa-lock text-gray-400"></i>
                </div>
                <input
                  type="password"
                  id="login-password"
                  x-model="password"
                  class="form-input block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  placeholder="Masukkan password"
                />
              </div>
            </div>

            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center">
                <input
                  id="remember-me"
                  name="remember-me"
                  type="checkbox"
                  x-model="rememberMe"
                  class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"
                />
                <label
                  for="remember-me"
                  class="ml-2 block text-sm text-gray-700"
                  >Ingat saya</label
                >
              </div>

              <div class="text-sm">
                <a
                  href="#"
                  class="font-medium text-primary-600 hover:text-primary-500"
                  >Lupa password?</a
                >
              </div>
            </div>

            <div
              x-show="showError"
              class="mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm"
            >
              <i class="fas fa-exclamation-circle mr-2"></i>
              <span x-text="errorMessage"></span>
            </div>

            <button
              type="submit"
              class="login-btn w-full flex justify-center py-2 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"
            >
              <i class="fas fa-sign-in-alt mr-2"></i>Login
            </button>
          </form>

          <div class="mt-6 text-center">
            <p class="text-sm text-gray-600">
              Belum memiliki akun?
              <a
                href="#"
                class="font-medium text-primary-600 hover:text-primary-500"
                >Hubungi administrator</a
              >
            </p>
          </div>

          <div class="mt-8 pt-6 border-t border-gray-200">
            <h3
              class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3"
            >
              Demo Credentials
            </h3>
            <div class="space-y-2 text-xs text-gray-600">
              <div class="flex justify-between">
                <span>Administrator:</span>
                <span class="font-mono">admin / admin123</span>
              </div>
              <div class="flex justify-between">
                <span>Operator:</span>
                <span class="font-mono">operator / operator123</span>
              </div>
              <div class="flex justify-between">
                <span>Viewer:</span>
                <span class="font-mono">viewer / viewer123</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard Content -->
    <div x-show="isLoggedIn" x-cloak>
      <!-- Notification Container -->
      <div class="fixed top-4 right-4 z-50 space-y-2">
        <template x-for="notification in notifications" :key="notification.id">
          <div
            class="notification p-4 rounded-lg shadow-lg flex items-center"
            :class="{
                           'bg-blue-500 text-white': notification.type === 'info',
                           'bg-green-500 text-white': notification.type === 'success',
                           'bg-yellow-500 text-white': notification.type === 'warning',
                           'bg-red-500 text-white': notification.type === 'error'
                         }"
          >
            <i
              class="fas mr-2"
              :class="{
                             'fa-info-circle': notification.type === 'info',
                             'fa-check-circle': notification.type === 'success',
                             'fa-exclamation-triangle': notification.type === 'warning',
                             'fa-times-circle': notification.type === 'error'
                           }"
            ></i>
            <span x-text="notification.message"></span>
          </div>
        </template>
      </div>

      <!-- Session Timeout Warning -->
      <div
        x-show="sessionTimeLeft <= 5 && sessionTimeLeft > 0"
        class="fixed bottom-4 right-4 z-50 bg-yellow-500 text-white p-4 rounded-lg shadow-lg animate-pulse"
      >
        <div class="flex items-center">
          <i class="fas fa-exclamation-triangle mr-2"></i>
          <span
            >Sesi akan berakhir dalam
            <span x-text="sessionTimeLeft"></span> menit</span
          >
          <button
            @click="extendSession()"
            class="ml-4 px-3 py-1 bg-white text-yellow-600 rounded text-sm font-medium"
          >
            Perpanjang
          </button>
        </div>
      </div>

      <!-- Sidebar -->
      <div
        class="sidebar fixed top-0 left-0 h-full bg-white dark:bg-gray-800 shadow-lg z-40 flex flex-col"
        :class="{ 'collapsed': sidebarCollapsed }"
      >
        <div
          class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
        >
          <div class="flex items-center" x-show="!sidebarCollapsed">
            <div
              class="w-10 h-10 rounded-lg bg-primary-600 flex items-center justify-center"
            >
              <i class="fas fa-globe-americas text-white"></i>
            </div>
            <h1 class="ml-3 text-xl font-bold">Microwave NMS</h1>
          </div>
          <div
            x-show="sidebarCollapsed"
            class="w-10 h-10 rounded-lg bg-primary-600 flex items-center justify-center mx-auto"
          >
            <i class="fas fa-globe-americas text-white"></i>
          </div>
          <button
            @click="toggleSidebar()"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none"
          >
            <i
              class="fas"
              :class="sidebarCollapsed ? 'fa-chevron-right' : 'fa-chevron-left'"
            ></i>
          </button>
        </div>

        <nav class="flex-1 overflow-y-auto py-4">
          <ul>
            <li
              class="px-4 py-2"
              x-show="hasPermission('dashboard.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('dashboard')"
                class="flex items-center"
                :class="currentView === 'dashboard' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-home w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Dashboard</span>
              </a>
            </li>
            <li
              class="px-4 py-2"
              x-show="hasPermission('sites.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('sites')"
                class="flex items-center"
                :class="currentView === 'sites' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-satellite-dish w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Sites</span>
              </a>
            </li>
            <li
              class="px-4 py-2"
              x-show="hasPermission('links.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('links')"
                class="flex items-center"
                :class="currentView === 'links' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-network-wired w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Links</span>
              </a>
            </li>
            <li
              class="px-4 py-2"
              x-show="hasPermission('reports.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('reports')"
                class="flex items-center"
                :class="currentView === 'reports' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-chart-line w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Reports</span>
              </a>
            </li>
            <li
              class="px-4 py-2"
              x-show="hasPermission('alerts.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('alerts')"
                class="flex items-center"
                :class="currentView === 'alerts' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-bell w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Alerts</span>
                <span
                  x-show="!sidebarCollapsed"
                  class="ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"
                  >3</span
                >
              </a>
            </li>
            <li
              class="px-4 py-2"
              x-show="hasPermission('settings.read') || hasPermission('all')"
            >
              <a
                href="#"
                @click.prevent="navigate('settings')"
                class="flex items-center"
                :class="currentView === 'settings' ? 'text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 rounded-lg px-3 py-2' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2'"
              >
                <i class="fas fa-cog w-5"></i>
                <span x-show="!sidebarCollapsed" class="ml-3">Settings</span>
              </a>
            </li>
            <!-- Admin only items -->
            <template x-if="currentUser.role === 'administrator'">
              <div>
                <li class="px-4 py-2">
                  <a
                    href="#"
                    @click.prevent="showUserManagement = true"
                    class="flex items-center text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2"
                  >
                    <i class="fas fa-users w-5"></i>
                    <span x-show="!sidebarCollapsed" class="ml-3"
                      >User Management</span
                    >
                  </a>
                </li>
                <li class="px-4 py-2">
                  <a
                    href="#"
                    @click.prevent="showPermissionRequests = true"
                    class="flex items-center text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2"
                  >
                    <i class="fas fa-user-check w-5"></i>
                    <span x-show="!sidebarCollapsed" class="ml-3"
                      >Permission Requests</span
                    >
                    <span
                      x-show="!sidebarCollapsed"
                      class="ml-auto bg-yellow-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"
                      x-text="permissionRequests.filter(r => r.status === 'pending').length"
                    ></span>
                  </a>
                </li>
                <li class="px-4 py-2">
                  <a
                    href="#"
                    @click.prevent="showAuditLog = true"
                    class="flex items-center text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-3 py-2"
                  >
                    <i class="fas fa-history w-5"></i>
                    <span x-show="!sidebarCollapsed" class="ml-3"
                      >Audit Log</span
                    >
                  </a>
                </li>
              </div>
            </template>
          </ul>
        </nav>

        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
          <div class="flex items-center" x-show="!sidebarCollapsed">
            <div
              class="w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center"
            >
              <i class="fas fa-user text-gray-600 dark:text-gray-300"></i>
            </div>
            <div class="ml-3">
              <p class="text-sm font-medium" x-text="currentUser.name"></p>
              <div class="flex items-center">
                <span
                  class="text-xs px-1 py-0.5 rounded"
                  :class="roles[currentUser.role].color"
                  x-text="roles[currentUser.role].name"
                ></span>
                <span class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                  >â€¢</span
                >
                <span
                  class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                  x-text="sessionTimeLeft + 'm'"
                ></span>
              </div>
            </div>
          </div>
          <div x-show="sidebarCollapsed" class="flex justify-center">
            <div
              class="w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center"
            >
              <i class="fas fa-user text-gray-600 dark:text-gray-300"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content" :class="{ 'expanded': sidebarCollapsed }">
        <!-- Top Navigation Bar -->
        <header class="bg-white dark:bg-gray-800 shadow-sm">
          <div class="flex items-center justify-between p-4">
            <div class="flex items-center">
              <button
                @click="toggleSidebar()"
                class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 mr-4 focus:outline-none"
              >
                <i class="fas fa-bars"></i>
              </button>
              <div>
                <h2
                  class="text-xl font-semibold"
                  x-text="currentView === 'dashboard' ? 'Network Dashboard' : 
                                                                  currentView === 'sites' ? 'Network Sites' :
                                                                  currentView === 'links' ? 'Network Links' :
                                                                  currentView === 'reports' ? 'Network Reports' :
                                                                  currentView === 'alerts' ? 'Network Alerts' :
                                                                  currentView === 'settings' ? 'System Settings' : ''"
                ></h2>
                <nav
                  class="text-sm text-gray-500 dark:text-gray-400"
                  aria-label="Breadcrumb"
                >
                  <ol class="flex items-center space-x-1">
                    <li>
                      <a
                        href="#"
                        @click.prevent="navigate('dashboard')"
                        class="hover:text-primary-600 dark:hover:text-primary-400"
                        >Home</a
                      >
                    </li>
                    <li
                      class="flex items-center"
                      x-show="currentView !== 'dashboard'"
                    >
                      <i class="fas fa-chevron-right text-xs mx-1"></i>
                      <span
                        x-text="currentView === 'sites' ? 'Sites' :
                                                        currentView === 'links' ? 'Links' :
                                                        currentView === 'reports' ? 'Reports' :
                                                        currentView === 'alerts' ? 'Alerts' :
                                                        currentView === 'settings' ? 'Settings' : ''"
                      ></span>
                    </li>
                  </ol>
                </nav>
              </div>
            </div>

            <div class="flex items-center space-x-4">
              <!-- Search Bar -->
              <div class="relative hidden md:block">
                <input
                  type="text"
                  placeholder="Search..."
                  class="pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                />
                <i
                  class="fas fa-search absolute left-3 top-3 text-gray-400"
                ></i>
              </div>

              <!-- Dark Mode Toggle -->
              <button
                @click="toggleDarkMode()"
                class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none"
              >
                <i class="fas" :class="darkMode ? 'fa-sun' : 'fa-moon'"></i>
              </button>

              <!-- Notification Bell -->
              <div class="relative" x-data="{ open: false }">
                <button
                  @click="open = !open"
                  class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none"
                >
                  <i class="fas fa-bell"></i>
                  <span
                    class="absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"
                    >3</span
                  >
                </button>

                <div
                  x-show="open"
                  @click.away="open = false"
                  x-transition
                  class="absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg z-50"
                >
                  <div
                    class="p-4 border-b border-gray-200 dark:border-gray-700"
                  >
                    <h3 class="font-medium">Notifications</h3>
                  </div>
                  <div class="max-h-96 overflow-y-auto">
                    <a
                      href="#"
                      @click.prevent="navigate('alerts'); open = false"
                      class="block p-4 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700"
                    >
                      <div class="flex">
                        <div class="flex-shrink-0 mr-3">
                          <div
                            class="w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center"
                          >
                            <i
                              class="fas fa-exclamation-triangle text-yellow-500"
                            ></i>
                          </div>
                        </div>
                        <div>
                          <p class="font-medium">Link Degradation</p>
                          <p class="text-sm text-gray-500 dark:text-gray-400">
                            JKT-SBY link experiencing high latency
                          </p>
                          <p
                            class="text-xs text-gray-400 dark:text-gray-500 mt-1"
                          >
                            10 minutes ago
                          </p>
                        </div>
                      </div>
                    </a>
                    <a
                      href="#"
                      @click.prevent="navigate('alerts'); open = false"
                      class="block p-4 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700"
                    >
                      <div class="flex">
                        <div class="flex-shrink-0 mr-3">
                          <div
                            class="w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"
                          >
                            <i class="fas fa-times-circle text-red-500"></i>
                          </div>
                        </div>
                        <div>
                          <p class="font-medium">Site Offline</p>
                          <p class="text-sm text-gray-500 dark:text-gray-400">
                            Site BDG-01 has been offline for 2 hours
                          </p>
                          <p
                            class="text-xs text-gray-400 dark:text-gray-500 mt-1"
                          >
                            2 hours ago
                          </p>
                        </div>
                      </div>
                    </a>
                    <a
                      href="#"
                      @click.prevent="navigate('alerts'); open = false"
                      class="block p-4 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <div class="flex">
                        <div class="flex-shrink-0 mr-3">
                          <div
                            class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center"
                          >
                            <i class="fas fa-check-circle text-green-500"></i>
                          </div>
                        </div>
                        <div>
                          <p class="font-medium">Maintenance Complete</p>
                          <p class="text-sm text-gray-500 dark:text-gray-400">
                            Scheduled maintenance on SMG-01 completed
                          </p>
                          <p
                            class="text-xs text-gray-400 dark:text-gray-500 mt-1"
                          >
                            Yesterday
                          </p>
                        </div>
                      </div>
                    </a>
                  </div>
                  <div
                    class="p-3 text-center border-t border-gray-200 dark:border-gray-700"
                  >
                    <a
                      href="#"
                      @click.prevent="navigate('alerts'); open = false"
                      class="text-sm text-primary-600 dark:text-primary-400 hover:underline"
                      >View all notifications</a
                    >
                  </div>
                </div>
              </div>

              <!-- User Profile -->
              <div class="relative" x-data="{ open: false }">
                <button
                  @click="open = !open"
                  class="flex items-center focus:outline-none"
                >
                  <div
                    class="w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center"
                  >
                    <i class="fas fa-user text-gray-600 dark:text-gray-300"></i>
                  </div>
                </button>

                <div
                  x-show="open"
                  @click.away="open = false"
                  x-transition
                  class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg z-50"
                >
                  <div class="py-1">
                    <a
                      href="#"
                      @click="showProfile = true; open = false"
                      class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-user-circle mr-2"></i>Profile
                    </a>
                    <a
                      href="#"
                      @click="showSettings = true; open = false"
                      class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-cog mr-2"></i>Settings
                    </a>
                    <hr class="my-1 border-gray-200 dark:border-gray-700" />
                    <a
                      href="#"
                      @click="logout(); open = false"
                      class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Main Dashboard Content -->
        <main class="p-6">
          <!-- Dashboard View (Default) -->
          <div x-show="currentView === 'dashboard'">
            <!-- Stats Overview -->
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6"
            >
              <div
                class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 metric-card"
              >
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">
                      Total Sites
                    </p>
                    <p class="text-2xl font-bold mt-1">42</p>
                    <p class="text-green-500 text-sm mt-1">
                      <i class="fas fa-arrow-up mr-1"></i>3.2%
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center"
                  >
                    <i class="fas fa-broadcast-tower text-blue-500 text-xl"></i>
                  </div>
                </div>
              </div>

              <div
                class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 metric-card"
              >
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">
                      Active Links
                    </p>
                    <p class="text-2xl font-bold mt-1">38</p>
                    <p class="text-green-500 text-sm mt-1">
                      <i class="fas fa-arrow-up mr-1"></i>1.8%
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center"
                  >
                    <i class="fas fa-network-wired text-green-500 text-xl"></i>
                  </div>
                </div>
              </div>

              <div
                class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 metric-card"
              >
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">
                      Alerts
                    </p>
                    <p class="text-2xl font-bold mt-1">7</p>
                    <p class="text-red-500 text-sm mt-1">
                      <i class="fas fa-arrow-up mr-1"></i>12.5%
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"
                  >
                    <i
                      class="fas fa-exclamation-triangle text-red-500 text-xl"
                    ></i>
                  </div>
                </div>
              </div>

              <div
                class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 metric-card"
              >
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">
                      Avg. Uptime
                    </p>
                    <p class="text-2xl font-bold mt-1">99.8%</p>
                    <p class="text-green-500 text-sm mt-1">
                      <i class="fas fa-arrow-up mr-1"></i>0.2%
                    </p>
                  </div>
                  <div
                    class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center"
                  >
                    <i class="fas fa-chart-line text-purple-500 text-xl"></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- Map and Controls Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
              <!-- Map Section -->
              <div
                class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
              >
                <div
                  class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
                >
                  <h3 class="font-semibold flex items-center">
                    <i
                      class="fas fa-globe-americas mr-2 text-primary-600 dark:text-primary-400"
                    ></i>
                    3D Network Visualization
                  </h3>
                  <div class="flex space-x-2">
                    <button
                      class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400"
                      title="Fullscreen"
                    >
                      <i class="fas fa-expand"></i>
                    </button>
                    <button
                      class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400"
                      title="Layer Settings"
                    >
                      <i class="fas fa-layer-group"></i>
                    </button>
                  </div>
                </div>
                <div class="p-1">
                  <div
                    id="cesiumContainer"
                    class="map-container rounded-lg"
                  ></div>
                </div>
                <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                  <div class="mb-3">
                    <h4 class="font-medium mb-2">Upload Network Data</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                      Upload KML/KMZ files to visualize your network sites and
                      links on the 3D globe
                    </p>
                  </div>
                  <form id="uploadForm" class="flex flex-col sm:flex-row gap-2">
                    <div class="flex-grow">
                      <input
                        type="file"
                        name="file"
                        accept=".kml,.kmz"
                        class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                        required
                      />
                    </div>
                    <button
                      type="submit"
                      class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center justify-center transition-colors"
                    >
                      <i class="fas fa-upload mr-2"></i>Upload
                    </button>
                  </form>
                  <div class="mt-3 text-sm text-gray-500 dark:text-gray-400">
                    <p>
                      <i class="fas fa-info-circle mr-1"></i> Supported formats:
                      KML, KMZ
                    </p>
                    <p>
                      <i class="fas fa-info-circle mr-1"></i> Maximum file size:
                      10MB
                    </p>
                  </div>
                </div>
              </div>

              <!-- Control Panel -->
              <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold flex items-center">
                    <i
                      class="fas fa-filter mr-2 text-primary-600 dark:text-primary-400"
                    ></i>
                    Data Filter
                  </h3>
                </div>
                <div class="p-4">
                  <form id="dataForm">
                    <div class="mb-4">
                      <label
                        class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                        >Select Link</label
                      >
                      <select
                        id="linkSelect"
                        class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                      >
                        <option value="">Loading...</option>
                      </select>
                    </div>

                    <div class="grid grid-cols-2 gap-3 mb-4">
                      <div>
                        <label
                          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                          >Start Date</label
                        >
                        <input
                          type="date"
                          id="startDate"
                          class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                          required
                        />
                      </div>
                      <div>
                        <label
                          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                          >End Date</label
                        >
                        <input
                          type="date"
                          id="endDate"
                          class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                          required
                        />
                      </div>
                    </div>

                    <button
                      type="submit"
                      class="w-full py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center justify-center transition-colors"
                    >
                      <i class="fas fa-sync-alt mr-2"></i>Get Data
                    </button>
                  </form>
                </div>

                <!-- Metrics Cards -->
                <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold mb-3">Link Metrics</h3>
                  <div class="grid grid-cols-2 gap-3">
                    <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3">
                      <div class="flex items-center justify-between mb-1">
                        <span class="text-sm text-gray-600 dark:text-gray-400"
                          >RSL Max</span
                        >
                        <i class="fas fa-signal text-blue-500"></i>
                      </div>
                      <div class="flex items-baseline">
                        <span class="text-xl font-bold" id="rslMax">--</span>
                        <span
                          class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                          >dBm</span
                        >
                      </div>
                    </div>

                    <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-3">
                      <div class="flex items-center justify-between mb-1">
                        <span class="text-sm text-gray-600 dark:text-gray-400"
                          >RSL Min</span
                        >
                        <i class="fas fa-signal text-red-500"></i>
                      </div>
                      <div class="flex items-baseline">
                        <span class="text-xl font-bold" id="rslMin">--</span>
                        <span
                          class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                          >dBm</span
                        >
                      </div>
                    </div>

                    <div
                      class="bg-green-50 dark:bg-green-900/20 rounded-lg p-3"
                    >
                      <div class="flex items-center justify-between mb-1">
                        <span class="text-sm text-gray-600 dark:text-gray-400"
                          >Throughput Max</span
                        >
                        <i class="fas fa-tachometer-alt text-green-500"></i>
                      </div>
                      <div class="flex items-baseline">
                        <span class="text-xl font-bold" id="throughputMax"
                          >--</span
                        >
                        <span
                          class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                          >Mbps</span
                        >
                      </div>
                    </div>

                    <div
                      class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3"
                    >
                      <div class="flex items-center justify-between mb-1">
                        <span class="text-sm text-gray-600 dark:text-gray-400"
                          >Utilization Max</span
                        >
                        <i class="fas fa-percentage text-yellow-500"></i>
                      </div>
                      <div class="flex items-baseline">
                        <span class="text-xl font-bold" id="utilMax">--</span>
                        <span
                          class="text-xs text-gray-500 dark:text-gray-400 ml-1"
                          >%</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Charts Section -->
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <ul
                  class="flex space-x-6 border-b border-gray-200 dark:border-gray-700 -mb-px"
                >
                  <li>
                    <a
                      href="#"
                      class="py-2 px-1 border-b-2 border-primary-600 font-medium text-primary-600 dark:text-primary-400"
                      data-tab="rsl-tab"
                    >
                      <i class="fas fa-signal mr-1"></i>RSL
                    </a>
                  </li>
                  <li>
                    <a
                      href="#"
                      class="py-2 px-1 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                      data-tab="util-tab"
                    >
                      <i class="fas fa-percentage mr-1"></i>Utilization
                    </a>
                  </li>
                  <li>
                    <a
                      href="#"
                      class="py-2 px-1 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                      data-tab="throughput-tab"
                    >
                      <i class="fas fa-tachometer-alt mr-1"></i>Throughput
                    </a>
                  </li>
                  <li>
                    <a
                      href="#"
                      class="py-2 px-1 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                      data-tab="errors-tab"
                    >
                      <i class="fas fa-exclamation-circle mr-1"></i>Errors
                    </a>
                  </li>
                </ul>
              </div>

              <div class="p-4">
                <div class="tab-content">
                  <div id="rsl-tab" class="tab-pane">
                    <div class="chart-container">
                      <canvas id="rslChart"></canvas>
                    </div>
                  </div>
                  <div id="util-tab" class="tab-pane hidden">
                    <div class="chart-container">
                      <canvas id="utilChart"></canvas>
                    </div>
                  </div>
                  <div id="throughput-tab" class="tab-pane hidden">
                    <div class="chart-container">
                      <canvas id="throughputChart"></canvas>
                    </div>
                  </div>
                  <div id="errors-tab" class="tab-pane hidden">
                    <div class="chart-container">
                      <canvas id="errorsChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Recent Alerts Table -->
            <div
              class="mt-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div
                class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
              >
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-exclamation-circle mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  Recent Alerts
                </h3>
                <a
                  href="#"
                  @click.prevent="navigate('alerts')"
                  class="text-sm text-primary-600 dark:text-primary-400 hover:underline"
                  >View all</a
                >
              </div>
              <div class="overflow-x-auto">
                <table
                  class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"
                >
                  <thead class="bg-gray-50 dark:bg-gray-700">
                    <tr>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Time
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Site
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Alert Type
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Severity
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Status
                      </th>
                      <th
                        scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                      >
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
                  >
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        10:45 AM
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                      >
                        JKT-01
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        High Latency
                      </td>
                      <td class="px-6 py-4 whitespace-nowrap">
                        <span
                          class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"
                          >Warning</span
                        >
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Active
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium"
                      >
                        <a
                          href="#"
                          x-show="hasPermission('alerts.acknowledge')"
                          @click.prevent="showNotification('Alert acknowledged!', 'success')"
                          class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"
                          >Acknowledge</a
                        >
                        <span
                          x-show="!hasPermission('alerts.acknowledge')"
                          class="text-gray-400"
                          >No permission</span
                        >
                      </td>
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        09:30 AM
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                      >
                        BDG-02
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Link Down
                      </td>
                      <td class="px-6 py-4 whitespace-nowrap">
                        <span
                          class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"
                          >Critical</span
                        >
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Active
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium"
                      >
                        <a
                          href="#"
                          x-show="hasPermission('alerts.acknowledge')"
                          @click.prevent="showNotification('Alert acknowledged!', 'success')"
                          class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"
                          >Acknowledge</a
                        >
                        <span
                          x-show="!hasPermission('alerts.acknowledge')"
                          class="text-gray-400"
                          >No permission</span
                        >
                      </td>
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Yesterday
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                      >
                        SMG-03
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Power Supply
                      </td>
                      <td class="px-6 py-4 whitespace-nowrap">
                        <span
                          class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"
                          >Info</span
                        >
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                      >
                        Resolved
                      </td>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium"
                      >
                        <a
                          href="#"
                          class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300"
                          >View</a
                        >
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Sites View -->
          <div x-show="currentView === 'sites'" class="animate-fade-in">
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div
                class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
              >
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-broadcast-tower mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  Network Sites
                </h3>
                <button
                  x-show="hasPermission('sites.create')"
                  @click="showAddSiteModal = true"
                  class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center"
                >
                  <i class="fas fa-plus mr-2"></i>Add Site
                </button>
              </div>

              <div class="p-4">
                <div
                  class="mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"
                >
                  <div class="relative flex-grow max-w-md">
                    <input
                      type="text"
                      placeholder="Search sites..."
                      class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                    />
                    <i
                      class="fas fa-search absolute left-3 top-3 text-gray-400"
                    ></i>
                  </div>
                  <div class="flex space-x-2">
                    <button
                      @click="siteFilter.status = siteFilter.status === '' ? 'Online' : (siteFilter.status === 'Online' ? 'Offline' : (siteFilter.status === 'Offline' ? 'Warning' : ''))"
                      class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                    <button
                      @click="exportSites()"
                      class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-download mr-1"></i>Export
                    </button>
                  </div>
                </div>

                <div class="overflow-x-auto">
                  <table
                    class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"
                  >
                    <thead class="bg-gray-50 dark:bg-gray-700">
                      <tr>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Site ID
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Name
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Location
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Status
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Links
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Last Update
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                        >
                          Actions
                        </th>
                      </tr>
                    </thead>
                    <tbody
                      class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
                    >
                      <template
                        x-for="site in sites.filter(s => siteFilter.status === '' || s.status === siteFilter.status)"
                        :key="site.id"
                      >
                        <tr>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                            x-text="site.id"
                          ></td>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                            x-text="site.name"
                          ></td>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                            x-text="site.location"
                          ></td>
                          <td class="px-6 py-4 whitespace-nowrap">
                            <span
                              class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full"
                              :class="site.status === 'Online' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400' : 
                                                              site.status === 'Offline' ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400' : 
                                                              'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400'"
                              x-text="site.status"
                            ></span>
                          </td>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                            x-text="site.links"
                          ></td>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                            x-text="site.lastUpdate"
                          ></td>
                          <td
                            class="px-6 py-4 whitespace-nowrap text-sm font-medium"
                          >
                            <a
                              href="#"
                              class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-3"
                              >View</a
                            >
                            <a
                              href="#"
                              x-show="hasPermission('sites.update')"
                              class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"
                              >Edit</a
                            >
                          </td>
                        </tr>
                      </template>
                    </tbody>
                  </table>
                </div>

                <div class="mt-4 flex items-center justify-between">
                  <div class="text-sm text-gray-700 dark:text-gray-300">
                    Showing <span class="font-medium">1</span> to
                    <span class="font-medium">4</span> of
                    <span class="font-medium">42</span> results
                  </div>
                  <div class="flex space-x-2">
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"
                      disabled
                    >
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      1
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400"
                    >
                      2
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      3
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Links View -->
          <div x-show="currentView === 'links'" class="animate-fade-in">
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div
                class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
              >
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-network-wired mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  Network Links
                </h3>
                <div class="flex space-x-2">
                  <label
                    x-show="hasPermission('links.create')"
                    class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center cursor-pointer"
                  >
                    <i class="fas fa-plus mr-2"></i>Add Link
                  </label>
                  <label
                    x-show="hasPermission('links.create')"
                    class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center cursor-pointer"
                  >
                    <i class="fas fa-file-import mr-2"></i>Import
                    <input
                      type="file"
                      accept=".xlsx,.xls,.csv"
                      class="hidden"
                      @change="uploadLinks($event)"
                    />
                  </label>
                </div>
              </div>

              <div class="p-4">
                <div
                  class="mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"
                >
                  <div class="relative flex-grow max-w-md">
                    <input
                      type="text"
                      placeholder="Search links..."
                      class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                    />
                    <i
                      class="fas fa-search absolute left-3 top-3 text-gray-400"
                    ></i>
                  </div>
                  <div class="flex space-x-2">
                    <select
                      x-model="linkFilter.status"
                      class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                    >
                      <option value="">All Status</option>
                      <option value="Online">Online</option>
                      <option value="Offline">Offline</option>
                      <option value="Warning">Warning</option>
                    </select>
                    <button
                      @click="exportLinks()"
                      class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-download mr-1"></i>Export
                    </button>
                  </div>
                </div>

                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                >
                  <template
                    x-for="link in links.filter(l => linkFilter.status === '' || l.status === linkFilter.status)"
                    :key="link.id"
                  >
                    <div
                      class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow"
                    >
                      <div class="flex justify-between items-start mb-3">
                        <div>
                          <h4 class="font-medium" x-text="link.name"></h4>
                          <p
                            class="text-sm text-gray-500 dark:text-gray-400"
                            x-text="link.frequency"
                          ></p>
                        </div>
                        <span
                          class="px-2 py-1 text-xs rounded-full"
                          :class="link.status === 'Online' ? 'bg-green-100 text-green-800 dark:bg-green-900/30' : 
                                                      link.status === 'Offline' ? 'bg-red-100 text-red-800 dark:bg-red-900/30' : 
                                                      'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30'"
                          x-text="link.status"
                        ></span>
                      </div>

                      <div class="space-y-2 mb-3">
                        <div class="flex justify-between text-sm">
                          <span class="text-gray-500 dark:text-gray-400"
                            >Distance</span
                          >
                          <span x-text="link.distance"></span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-gray-500 dark:text-gray-400"
                            >Capacity</span
                          >
                          <span x-text="link.capacity"></span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-gray-500 dark:text-gray-400"
                            >RSL</span
                          >
                          <span x-text="link.rsl"></span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-gray-500 dark:text-gray-400"
                            >Utilization</span
                          >
                          <span x-text="link.utilization"></span>
                        </div>
                      </div>

                      <div
                        class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-3"
                      >
                        <div
                          class="h-2 rounded-full"
                          :class="link.status === 'Online' ? 'bg-green-600' : 
                                                      link.status === 'Offline' ? 'bg-red-600' : 
                                                      'bg-yellow-500'"
                          :style="`width: ${link.utilization.replace('%', '')}%`"
                        ></div>
                      </div>

                      <div class="flex justify-between">
                        <span
                          class="text-xs text-gray-500 dark:text-gray-400"
                          x-text="link.lastUpdate"
                        ></span>
                        <div class="flex space-x-2">
                          <button
                            class="text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-300"
                          >
                            <i class="fas fa-chart-line"></i>
                          </button>
                          <button
                            x-show="hasPermission('links.update')"
                            class="text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-300"
                          >
                            <i class="fas fa-cog"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </template>
                </div>

                <div class="mt-4 flex items-center justify-between">
                  <div class="text-sm text-gray-700 dark:text-gray-300">
                    Showing <span class="font-medium">1</span> to
                    <span class="font-medium">3</span> of
                    <span class="font-medium">38</span> results
                  </div>
                  <div class="flex space-x-2">
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"
                      disabled
                    >
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400"
                    >
                      1
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      2
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      3
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Reports View -->
          <div x-show="currentView === 'reports'" class="animate-fade-in">
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-chart-line mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  Network Reports
                </h3>
              </div>

              <div class="p-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                  <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                    <h4 class="font-medium mb-3">Generate New Report</h4>
                    <form class="space-y-3">
                      <div>
                        <label
                          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                          >Report Type</label
                        >
                        <select
                          class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"
                        >
                          <option>Performance Summary</option>
                          <option>Link Utilization</option>
                          <option>Availability Report</option>
                          <option>Alert History</option>
                        </select>
                      </div>
                      <div>
                        <label
                          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                          >Date Range</label
                        >
                        <div class="grid grid-cols-2 gap-2">
                          <input
                            type="date"
                            class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"
                          />
                          <input
                            type="date"
                            class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500"
                          />
                        </div>
                      </div>
                      <div>
                        <label
                          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                          >Format</label
                        >
                        <div class="flex space-x-2">
                          <label class="flex items-center">
                            <input
                              type="radio"
                              name="format"
                              class="mr-1"
                              checked
                            />
                            <span class="text-sm">PDF</span>
                          </label>
                          <label class="flex items-center">
                            <input type="radio" name="format" class="mr-1" />
                            <span class="text-sm">Excel</span>
                          </label>
                          <label class="flex items-center">
                            <input type="radio" name="format" class="mr-1" />
                            <span class="text-sm">CSV</span>
                          </label>
                        </div>
                      </div>
                      <button
                        type="button"
                        @click="showNotification('Report generation started!', 'info')"
                        class="w-full py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
                      >
                        Generate Report
                      </button>
                    </form>
                  </div>

                  <div class="md:col-span-2">
                    <h4 class="font-medium mb-3">Recent Reports</h4>
                    <div
                      class="border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"
                    >
                      <table
                        class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"
                      >
                        <thead class="bg-gray-50 dark:bg-gray-700">
                          <tr>
                            <th
                              scope="col"
                              class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                            >
                              Name
                            </th>
                            <th
                              scope="col"
                              class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                            >
                              Type
                            </th>
                            <th
                              scope="col"
                              class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                            >
                              Date
                            </th>
                            <th
                              scope="col"
                              class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                            >
                              Format
                            </th>
                            <th
                              scope="col"
                              class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                            >
                              Actions
                            </th>
                          </tr>
                        </thead>
                        <tbody
                          class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
                        >
                          <template
                            x-for="report in reports.recent"
                            :key="report.id"
                          >
                            <tr>
                              <td
                                class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                                x-text="report.name"
                              ></td>
                              <td
                                class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                                x-text="report.type"
                              ></td>
                              <td
                                class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                                x-text="report.date"
                              ></td>
                              <td
                                class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                                x-text="report.format"
                              ></td>
                              <td
                                class="px-4 py-3 whitespace-nowrap text-sm font-medium"
                              >
                                <button
                                  @click="downloadReport(report.id)"
                                  class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-2"
                                >
                                  <i class="fas fa-download"></i>
                                </button>
                                <button
                                  x-show="hasPermission('reports.delete')"
                                  @click="deleteReport(report.id)"
                                  class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"
                                >
                                  <i class="fas fa-trash"></i>
                                </button>
                              </td>
                            </tr>
                          </template>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>

                <div>
                  <h4 class="font-medium mb-3">Scheduled Reports</h4>
                  <div
                    class="border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"
                  >
                    <table
                      class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"
                    >
                      <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Name
                          </th>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Type
                          </th>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Schedule
                          </th>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Recipients
                          </th>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Status
                          </th>
                          <th
                            scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                          >
                            Actions
                          </th>
                        </tr>
                      </thead>
                      <tbody
                        class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
                      >
                        <template
                          x-for="report in reports.scheduled"
                          :key="report.id"
                        >
                          <tr>
                            <td
                              class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100"
                              x-text="report.name"
                            ></td>
                            <td
                              class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                              x-text="report.type"
                            ></td>
                            <td
                              class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                              x-text="report.schedule"
                            ></td>
                            <td
                              class="px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                              x-text="report.recipients"
                            ></td>
                            <td class="px-4 py-3 whitespace-nowrap">
                              <span
                                class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"
                                x-text="report.status"
                              ></span>
                            </td>
                            <td
                              class="px-4 py-3 whitespace-nowrap text-sm font-medium"
                            >
                              <button
                                @click="editScheduledReport(report.id)"
                                class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-2"
                              >
                                <i class="fas fa-edit"></i>
                              </button>
                              <button
                                @click="deleteScheduledReport(report.id)"
                                class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"
                              >
                                <i class="fas fa-trash"></i>
                              </button>
                            </td>
                          </tr>
                        </template>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Alerts View -->
          <div x-show="currentView === 'alerts'" class="animate-fade-in">
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div
                class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
              >
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-exclamation-circle mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  Network Alerts
                </h3>
                <div class="flex space-x-2">
                  <button
                    class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                  >
                    <i class="fas fa-filter mr-2"></i>Filter
                  </button>
                  <button
                    x-show="hasPermission('alerts.acknowledge')"
                    class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
                  >
                    <i class="fas fa-check-double mr-2"></i>Acknowledge All
                  </button>
                </div>
              </div>

              <div class="p-4">
                <div
                  class="mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"
                >
                  <div class="flex flex-wrap gap-2">
                    <button
                      class="px-3 py-1 bg-primary-600 text-white rounded-full text-sm"
                    >
                      All (7)
                    </button>
                    <button
                      class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600"
                    >
                      Critical (2)
                    </button>
                    <button
                      class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600"
                    >
                      Warning (3)
                    </button>
                    <button
                      class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600"
                    >
                      Info (2)
                    </button>
                  </div>
                  <div class="flex space-x-2">
                    <select
                      class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                    >
                      <option>All Status</option>
                      <option>Active</option>
                      <option>Acknowledged</option>
                      <option>Resolved</option>
                    </select>
                  </div>
                </div>

                <div class="space-y-4">
                  <div
                    class="border-l-4 border-red-500 bg-red-50 dark:bg-red-900/20 p-4 rounded-r-lg"
                  >
                    <div class="flex justify-between">
                      <div>
                        <h4 class="font-medium text-red-800 dark:text-red-400">
                          Critical: Site BDG-01 Offline
                        </h4>
                        <p class="text-sm text-red-700 dark:text-red-300 mt-1">
                          Site has been offline for more than 2 hours. All links
                          are down.
                        </p>
                        <div
                          class="mt-2 flex items-center text-sm text-red-600 dark:text-red-400"
                        >
                          <i class="fas fa-clock mr-1"></i>
                          <span>2 hours ago</span>
                          <i class="fas fa-map-marker-alt ml-3 mr-1"></i>
                          <span>BDG-01</span>
                        </div>
                      </div>
                      <div class="flex space-x-2">
                        <button
                          class="p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-900/30"
                        >
                          <i
                            class="fas fa-info-circle text-red-600 dark:text-red-400"
                          ></i>
                        </button>
                        <button
                          x-show="hasPermission('alerts.acknowledge')"
                          class="p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-900/30"
                        >
                          <i
                            class="fas fa-check text-red-600 dark:text-red-400"
                          ></i>
                        </button>
                      </div>
                    </div>
                  </div>

                  <div
                    class="border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-r-lg"
                  >
                    <div class="flex justify-between">
                      <div>
                        <h4
                          class="font-medium text-yellow-800 dark:text-yellow-400"
                        >
                          Warning: High Latency on JKT-SBY Link
                        </h4>
                        <p
                          class="text-sm text-yellow-700 dark:text-yellow-300 mt-1"
                        >
                          Link latency is above threshold (120ms). Quality of
                          service may be affected.
                        </p>
                        <div
                          class="mt-2 flex items-center text-sm text-yellow-600 dark:text-yellow-400"
                        >
                          <i class="fas fa-clock mr-1"></i>
                          <span>45 minutes ago</span>
                          <i class="fas fa-network-wired ml-3 mr-1"></i>
                          <span>JKT-01 to SBY-01</span>
                        </div>
                      </div>
                      <div class="flex space-x-2">
                        <button
                          class="p-2 rounded-full hover:bg-yellow-100 dark:hover:bg-yellow-900/30"
                        >
                          <i
                            class="fas fa-info-circle text-yellow-600 dark:text-yellow-400"
                          ></i>
                        </button>
                        <button
                          x-show="hasPermission('alerts.acknowledge')"
                          class="p-2 rounded-full hover:bg-yellow-100 dark:hover:bg-yellow-900/30"
                        >
                          <i
                            class="fas fa-check text-yellow-600 dark:text-yellow-400"
                          ></i>
                        </button>
                      </div>
                    </div>
                  </div>

                  <div
                    class="border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-r-lg"
                  >
                    <div class="flex justify-between">
                      <div>
                        <h4
                          class="font-medium text-blue-800 dark:text-blue-400"
                        >
                          Info: Scheduled Maintenance Completed
                        </h4>
                        <p
                          class="text-sm text-blue-700 dark:text-blue-300 mt-1"
                        >
                          Scheduled maintenance on SMG-01 has been completed
                          successfully.
                        </p>
                        <div
                          class="mt-2 flex items-center text-sm text-blue-600 dark:text-blue-400"
                        >
                          <i class="fas fa-clock mr-1"></i>
                          <span>Yesterday</span>
                          <i class="fas fa-map-marker-alt ml-3 mr-1"></i>
                          <span>SMG-01</span>
                        </div>
                      </div>
                      <div class="flex space-x-2">
                        <button
                          class="p-2 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/30"
                        >
                          <i
                            class="fas fa-info-circle text-blue-600 dark:text-blue-400"
                          ></i>
                        </button>
                        <button
                          x-show="hasPermission('alerts.acknowledge')"
                          class="p-2 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900/30"
                        >
                          <i
                            class="fas fa-check text-blue-600 dark:text-blue-400"
                          ></i>
                        </button>
                      </div>
                    </div>
                  </div>

                  <div
                    class="border-l-4 border-green-500 bg-green-50 dark:bg-green-900/20 p-4 rounded-r-lg"
                  >
                    <div class="flex justify-between">
                      <div>
                        <h4
                          class="font-medium text-green-800 dark:text-green-400"
                        >
                          Resolved: Link BDG-SMG Restored
                        </h4>
                        <p
                          class="text-sm text-green-700 dark:text-green-300 mt-1"
                        >
                          Link that was down has been restored and is now
                          operating normally.
                        </p>
                        <div
                          class="mt-2 flex items-center text-sm text-green-600 dark:text-green-400"
                        >
                          <i class="fas fa-clock mr-1"></i>
                          <span>2 hours ago</span>
                          <i class="fas fa-network-wired ml-3 mr-1"></i>
                          <span>BDG-01 to SMG-01</span>
                        </div>
                      </div>
                      <div class="flex space-x-2">
                        <button
                          class="p-2 rounded-full hover:bg-green-100 dark:hover:bg-green-900/30"
                        >
                          <i
                            class="fas fa-info-circle text-green-600 dark:text-green-400"
                          ></i>
                        </button>
                        <button
                          x-show="hasPermission('alerts.acknowledge')"
                          class="p-2 rounded-full hover:bg-green-100 dark:hover:bg-green-900/30"
                        >
                          <i
                            class="fas fa-check text-green-600 dark:text-green-400"
                          ></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mt-6 flex items-center justify-between">
                  <div class="text-sm text-gray-700 dark:text-gray-300">
                    Showing <span class="font-medium">1</span> to
                    <span class="font-medium">4</span> of
                    <span class="font-medium">7</span> alerts
                  </div>
                  <div class="flex space-x-2">
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"
                      disabled
                    >
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400"
                    >
                      1
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      2
                    </button>
                    <button
                      class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                    >
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Settings View -->
          <div x-show="currentView === 'settings'" class="animate-fade-in">
            <div
              class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"
            >
              <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="font-semibold flex items-center">
                  <i
                    class="fas fa-cog mr-2 text-primary-600 dark:text-primary-400"
                  ></i>
                  System Settings
                </h3>
              </div>

              <div class="p-4">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                  <div class="lg:col-span-1">
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                      <h4 class="font-medium mb-3">Settings Categories</h4>
                      <nav class="space-y-1">
                        <button
                          class="w-full text-left px-3 py-2 rounded-lg bg-primary-100 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300 font-medium"
                        >
                          General
                        </button>
                        <button
                          @click="toggleUsersPermissions()"
                          class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"
                        >
                          Users & Permissions
                        </button>
                        <button
                          @click="toggleNotifications()"
                          class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"
                        >
                          Notifications
                        </button>
                        <button
                          @click="updateDataSources('API')"
                          class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"
                        >
                          Data Sources
                        </button>
                        <button
                          @click="updateMapSettings('defaultView', '2D Map')"
                          class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"
                        >
                          Map Settings
                        </button>
                        <button
                          @click="performBackup()"
                          class="w-full text-left px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"
                        >
                          Backup & Restore
                        </button>
                      </nav>
                    </div>
                  </div>

                  <div class="lg:col-span-2">
                    <div
                      class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"
                    >
                      <h4 class="font-medium mb-4">General Settings</h4>

                      <div class="space-y-6">
                        <div>
                          <h5 class="font-medium mb-3">System Information</h5>
                          <div class="grid grid-cols-2 gap-4">
                            <div>
                              <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                                >System Name</label
                              >
                              <input
                                type="text"
                                value="Microwave NMS"
                                :disabled="!hasPermission('settings.update')"
                                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"
                              />
                            </div>
                            <div>
                              <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                                >Version</label
                              >
                              <input
                                type="text"
                                value="2.1.0"
                                readonly
                                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400"
                              />
                            </div>
                          </div>
                        </div>

                        <div>
                          <h5 class="font-medium mb-3">Appearance</h5>
                          <div class="space-y-3">
                            <div class="flex items-center justify-between">
                              <div>
                                <p class="font-medium">Dark Mode</p>
                                <p
                                  class="text-sm text-gray-500 dark:text-gray-400"
                                >
                                  Enable dark theme
                                </p>
                              </div>
                              <label
                                class="relative inline-flex items-center cursor-pointer"
                              >
                                <input
                                  type="checkbox"
                                  :checked="darkMode"
                                  @change="toggleDarkMode()"
                                  class="sr-only peer"
                                />
                                <div
                                  class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                                ></div>
                              </label>
                            </div>

                            <div>
                              <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                                >Language</label
                              >
                              <select
                                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                              >
                                <option>English</option>
                                <option selected>Bahasa Indonesia</option>
                              </select>
                            </div>

                            <div>
                              <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                                >Date Format</label
                              >
                              <select
                                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                              >
                                <option>MM/DD/YYYY</option>
                                <option selected>DD/MM/YYYY</option>
                                <option>YYYY-MM-DD</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div>
                          <h5 class="font-medium mb-3">Data Refresh</h5>
                          <div class="space-y-3">
                            <div class="flex items-center justify-between">
                              <div>
                                <p class="font-medium">Auto Refresh</p>
                                <p
                                  class="text-sm text-gray-500 dark:text-gray-400"
                                >
                                  Automatically refresh data
                                </p>
                              </div>
                              <label
                                class="relative inline-flex items-center cursor-pointer"
                              >
                                <input
                                  type="checkbox"
                                  class="sr-only peer"
                                  checked
                                />
                                <div
                                  class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                                ></div>
                              </label>
                            </div>

                            <div>
                              <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                                >Refresh Interval</label
                              >
                              <select
                                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                              >
                                <option>30 seconds</option>
                                <option selected>1 minute</option>
                                <option>5 minutes</option>
                                <option>10 minutes</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div
                          class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"
                        >
                          <button
                            class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
                          >
                            Cancel
                          </button>
                          <button
                            x-show="hasPermission('settings.update')"
                            @click="showNotification('Settings saved successfully!', 'success')"
                            class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
                          >
                            Save Changes
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>

        <!-- Footer -->
        <footer
          class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-4 px-6"
        >
          <div class="flex flex-col md:flex-row justify-between items-center">
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Â© 2023 Microwave NMS. All rights reserved.
            </p>
            <div class="flex space-x-6 mt-4 md:mt-0">
              <a
                href="#"
                class="text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"
                >Help Center</a
              >
              <a
                href="#"
                class="text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"
                >Terms</a
              >
              <a
                href="#"
                class="text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"
                >Privacy</a
              >
            </div>
          </div>
        </footer>
      </div>
    </div>

    <!-- Add Site Modal -->
    <div
      x-show="showAddSiteModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Add New Site</h3>
          <button
            @click="showAddSiteModal = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <form @submit.prevent="addSite()">
          <div class="space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Site ID *</label
              >
              <input
                type="text"
                x-model="newSite.id"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Site Name *</label
              >
              <input
                type="text"
                x-model="newSite.name"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Location *</label
              >
              <input
                type="text"
                x-model="newSite.location"
                placeholder="e.g., -6.2088, 106.8456"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Status</label
              >
              <select
                x-model="newSite.status"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
              >
                <option value="Online">Online</option>
                <option value="Offline">Offline</option>
                <option value="Warning">Warning</option>
              </select>
            </div>
          </div>

          <div class="mt-6 flex justify-end space-x-3">
            <button
              type="button"
              @click="showAddSiteModal = false"
              class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
            >
              Add Site
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Add Link Modal -->
    <div
      x-show="showAddLinkModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Add New Link</h3>
          <button
            @click="showAddLinkModal = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <form @submit.prevent="addLink()">
          <div class="space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Link Name *</label
              >
              <input
                type="text"
                x-model="newLink.name"
                placeholder="e.g., JKT-01 to BDG-01"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Frequency *</label
              >
              <input
                type="text"
                x-model="newLink.frequency"
                placeholder="e.g., 15 GHz"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Distance *</label
              >
              <input
                type="text"
                x-model="newLink.distance"
                placeholder="e.g., 120 km"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Capacity</label
              >
              <input
                type="text"
                x-model="newLink.capacity"
                placeholder="e.g., 1 Gbps"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Status</label
              >
              <select
                x-model="newLink.status"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
              >
                <option value="Online">Online</option>
                <option value="Offline">Offline</option>
                <option value="Warning">Warning</option>
              </select>
            </div>
          </div>

          <div class="mt-6 flex justify-end space-x-3">
            <button
              type="button"
              @click="showAddLinkModal = false"
              class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
            >
              Add Link
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Add User Modal -->
    <div
      x-show="showAddUserModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Add New User</h3>
          <button
            @click="showAddUserModal = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <form @submit.prevent="addUser()">
          <div class="space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Full Name *</label
              >
              <input
                type="text"
                x-model="newUser.name"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Email *</label
              >
              <input
                type="email"
                x-model="newUser.email"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Role</label
              >
              <select
                x-model="newUser.role"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
              >
                <option value="administrator">Administrator</option>
                <option value="operator">Operator</option>
                <option value="viewer">Viewer</option>
              </select>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Password</label
              >
              <input
                type="password"
                placeholder="Create a password"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                >Confirm Password</label
              >
              <input
                type="password"
                placeholder="Confirm password"
                class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                required
              />
            </div>
          </div>

          <div class="mt-6 flex justify-end space-x-3">
            <button
              type="button"
              @click="showAddUserModal = false"
              class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
            >
              Add User
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Profile Modal -->
    <div
      x-show="showProfile"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">User Profile</h3>
          <button
            @click="showProfile = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="flex flex-col items-center mb-6">
          <div
            class="w-24 h-24 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center mb-4"
          >
            <i
              class="fas fa-user text-4xl text-gray-600 dark:text-gray-300"
            ></i>
          </div>
          <h4 class="text-lg font-semibold" x-text="currentUser.name"></h4>
          <div class="flex items-center mt-1">
            <span
              class="px-2 py-1 text-xs rounded-full font-medium"
              :class="roles[currentUser.role].color"
              x-text="roles[currentUser.role].name"
            ></span>
          </div>
          <p
            class="text-gray-500 dark:text-gray-400 mt-1"
            x-text="currentUser.email"
          ></p>
        </div>

        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Full Name</label
            >
            <input
              type="text"
              :value="currentUser.name"
              :disabled="!hasPermission('users.update')"
              class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Email</label
            >
            <input
              type="email"
              :value="currentUser.email"
              :disabled="!hasPermission('users.update')"
              class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"
            />
          </div>
          <div x-show="hasPermission('users.update')">
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Role</label
            >
            <select
              class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
            >
              <option
                value="administrator"
                :selected="currentUser.role === 'administrator'"
              >
                Administrator
              </option>
              <option
                value="operator"
                :selected="currentUser.role === 'operator'"
              >
                Operator
              </option>
              <option value="viewer" :selected="currentUser.role === 'viewer'">
                Viewer
              </option>
            </select>
          </div>
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
              >Password</label
            >
            <input
              type="password"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              :disabled="!hasPermission('users.update')"
              class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"
            />
          </div>

          <!-- Permission Request Section for Non-Admins -->
          <div
            x-show="currentUser.role !== 'administrator'"
            class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4"
          >
            <h5 class="font-medium mb-2">Request Additional Permissions</h5>
            <div class="space-y-2">
              <template
                x-for="permission in ['sites.create', 'sites.delete', 'links.create', 'links.delete', 'alerts.create', 'settings.update']"
                :key="permission"
              >
                <div
                  x-show="!hasPermission(permission)"
                  class="flex items-center justify-between"
                >
                  <span
                    class="text-sm"
                    x-text="permission.replace('.', ' ').replace(/\b\w/g, l => l.toUpperCase())"
                  ></span>
                  <button
                    @click="requestAdditionalPermission(permission)"
                    class="text-xs px-2 py-1 bg-primary-600 text-white rounded hover:bg-primary-700"
                  >
                    Request
                  </button>
                </div>
              </template>
            </div>
          </div>
        </div>

        <div class="mt-6 flex justify-end space-x-3">
          <button
            @click="showProfile = false"
            class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
          >
            Cancel
          </button>
          <button
            x-show="hasPermission('users.update')"
            @click="showProfile = false; showNotification('Profile updated successfully!', 'success')"
            class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
          >
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div
      x-show="showSettings"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-2xl p-6 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">System Settings</h3>
          <button
            @click="showSettings = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="space-y-6">
          <div>
            <h4 class="font-medium mb-3">General Settings</h4>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">Dark Mode</p>
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Enable dark theme
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    :checked="darkMode"
                    @change="toggleDarkMode()"
                    class="sr-only peer"
                  />
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                  ></div>
                </label>
              </div>

              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">Auto Refresh</p>
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Automatically refresh data
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" class="sr-only peer" checked />
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                  ></div>
                </label>
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                  >Refresh Interval</label
                >
                <select
                  class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                >
                  <option>30 seconds</option>
                  <option selected>1 minute</option>
                  <option>5 minutes</option>
                  <option>10 minutes</option>
                </select>
              </div>
            </div>
          </div>

          <div>
            <h4 class="font-medium mb-3">Notification Settings</h4>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">Email Notifications</p>
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Receive alerts via email
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" class="sr-only peer" checked />
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                  ></div>
                </label>
              </div>

              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium">Push Notifications</p>
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Receive alerts in browser
                  </p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" class="sr-only peer" checked />
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"
                  ></div>
                </label>
              </div>
            </div>
          </div>

          <div>
            <h4 class="font-medium mb-3">Map Settings</h4>
            <div class="space-y-3">
              <div>
                <label
                  class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                  >Default View</label
                >
                <select
                  class="w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                >
                  <option>2D Map</option>
                  <option selected>3D Globe</option>
                  <option>Satellite</option>
                </select>
              </div>

              <div>
                <label
                  class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
                  >Default Location</label
                >
                <div class="grid grid-cols-2 gap-3">
                  <input
                    type="text"
                    placeholder="Latitude"
                    value="-6.2088"
                    class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                  />
                  <input
                    type="text"
                    placeholder="Longitude"
                    value="106.8456"
                    class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-6 flex justify-end space-x-3">
          <button
            @click="showSettings = false"
            class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
          >
            Cancel
          </button>
          <button
            @click="showSettings = false; showNotification('Settings saved successfully!', 'success')"
            class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg"
          >
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <!-- User Management Modal -->
    <div
      x-show="showUserManagement"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-4xl p-6 animate-fade-in max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">User Management</h3>
          <div class="flex space-x-2">
            <button
              @click="showAddUserModal = true"
              class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center"
            >
              <i class="fas fa-plus mr-2"></i>Add User
            </button>
            <button
              @click="showUserManagement = false"
              class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <div class="mb-4 flex justify-between items-center">
          <div class="relative flex-grow max-w-md">
            <input
              type="text"
              placeholder="Search users..."
              class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
            />
            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table
            class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"
          >
            <thead class="bg-gray-50 dark:bg-gray-700">
              <tr>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  User
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  Email
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  Role
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  Status
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  Last Login
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
                >
                  Actions
                </th>
              </tr>
            </thead>
            <tbody
              class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
            >
              <template x-for="user in users" :key="user.id">
                <tr>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div
                        class="w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center"
                      >
                        <i
                          class="fas fa-user text-gray-600 dark:text-gray-300"
                        ></i>
                      </div>
                      <div class="ml-4">
                        <div
                          class="text-sm font-medium text-gray-900 dark:text-gray-100"
                          x-text="user.name"
                        ></div>
                      </div>
                    </div>
                  </td>
                  <td
                    class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                    x-text="user.email"
                  ></td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span
                      class="px-2 py-1 text-xs rounded-full font-medium"
                      :class="roles[user.role].color"
                      x-text="roles[user.role].name"
                    ></span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span
                      class="px-2 py-1 text-xs rounded-full font-medium"
                      :class="user.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400' : 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'"
                      x-text="user.status"
                    ></span>
                  </td>
                  <td
                    class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"
                    x-text="user.lastLogin ? new Date(user.lastLogin).toLocaleString() : 'Never'"
                  ></td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button
                      @click="selectedUser = user; showUserPermissions = true"
                      class="text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-3"
                    >
                      Permissions
                    </button>
                    <div
                      class="relative inline-block text-left"
                      x-data="{ open: false }"
                    >
                      <button
                        @click="open = !open"
                        class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300"
                      >
                        <i class="fas fa-ellipsis-v"></i>
                      </button>
                      <div
                        x-show="open"
                        @click.away="open = false"
                        x-transition
                        class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg z-50"
                      >
                        <div class="py-1">
                          <a
                            href="#"
                            @click.prevent="editUser(user.id); open = false"
                            class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                          >
                            <i class="fas fa-edit mr-2"></i>Edit
                          </a>
                          <a
                            href="#"
                            @click.prevent="updateUserRole(user.id, user.role === 'administrator' ? 'operator' : user.role === 'operator' ? 'viewer' : 'administrator'); open = false"
                            class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                          >
                            <i class="fas fa-user-tag mr-2"></i>Change Role
                          </a>
                          <a
                            href="#"
                            @click.prevent="user.status = user.status === 'active' ? 'inactive' : 'active'; open = false"
                            class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                          >
                            <i
                              class="fas"
                              :class="user.status === 'active' ? 'fa-user-slash' : 'fa-user-check'"
                            ></i>
                            <span
                              x-text="user.status === 'active' ? ' Deactivate' : ' Activate'"
                            ></span>
                          </a>
                          <hr
                            class="my-1 border-gray-200 dark:border-gray-700"
                          />
                          <a
                            href="#"
                            @click.prevent="deleteUser(user.id); open = false"
                            class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"
                          >
                            <i class="fas fa-trash mr-2"></i>Delete
                          </a>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Permission Requests Modal -->
    <div
      x-show="showPermissionRequests"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-4xl p-6 animate-fade-in max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Permission Requests</h3>
          <button
            @click="showPermissionRequests = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="mb-4 flex space-x-2">
          <button
            @click="setPermissionTab('all')"
            :class="activePermissionTab === 'all' ? 'px-3 py-1 bg-primary-600 text-white rounded-full text-sm' : 'px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600'"
          >
            All
          </button>
          <button
            @click="setPermissionTab('pending')"
            :class="activePermissionTab === 'pending' ? 'px-3 py-1 bg-primary-600 text-white rounded-full text-sm' : 'px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600'"
          >
            Pending
          </button>
          <button
            @click="setPermissionTab('approved')"
            :class="activePermissionTab === 'approved' ? 'px-3 py-1 bg-primary-600 text-white rounded-full text-sm' : 'px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600'"
          >
            Approved
          </button>
          <button
            @click="setPermissionTab('rejected')"
            :class="activePermissionTab === 'rejected' ? 'px-3 py-1 bg-primary-600 text-white rounded-full text-sm' : 'px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600'"
          >
            Rejected
          </button>
        </div>

        <div class="space-y-4">
          <template
            x-for="request in getFilteredPermissionRequests()"
            :key="request.id"
          >
            <div
              class="border border-gray-200 dark:border-gray-700 rounded-lg p-4"
            >
              <div class="flex justify-between items-start">
                <div>
                  <div class="flex items-center mb-2">
                    <h4 class="font-medium mr-3" x-text="request.userName"></h4>
                    <span
                      class="px-2 py-1 text-xs rounded-full font-medium"
                      :class="roles[request.userRole].color"
                      x-text="roles[request.userRole].name"
                    ></span>
                  </div>
                  <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">
                    Requesting permission:
                    <span
                      class="font-medium"
                      x-text="request.requestedPermission.replace('.', ' ').replace(/\b\w/g, l => l.toUpperCase())"
                    ></span>
                  </p>
                  <p
                    class="text-sm text-gray-500 dark:text-gray-400 mb-2"
                    x-text="request.reason"
                  ></p>
                  <div
                    class="flex items-center text-xs text-gray-500 dark:text-gray-400"
                  >
                    <i class="fas fa-clock mr-1"></i>
                    <span>Requested: </span>
                    <span
                      x-text="new Date(request.requestedAt).toLocaleString()"
                    ></span>
                  </div>
                  <div
                    x-show="request.status !== 'pending'"
                    class="flex items-center text-xs text-gray-500 dark:text-gray-400 mt-1"
                  >
                    <i class="fas fa-user-check mr-1"></i>
                    <span
                      x-text="request.status === 'approved' ? 'Approved by: ' : 'Rejected by: '"
                    ></span>
                    <span x-text="request.reviewedBy"></span>
                    <span class="mx-2">â€¢</span>
                    <span
                      x-text="new Date(request.reviewedAt).toLocaleString()"
                    ></span>
                  </div>
                </div>
                <div class="flex space-x-2">
                  <span
                    class="px-2 py-1 text-xs rounded-full font-medium"
                    :class="request.status === 'pending' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400' : 
                                           request.status === 'approved' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400' : 
                                           'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'"
                    x-text="request.status"
                  ></span>
                  <div
                    x-show="request.status === 'pending' && hasPermission('users.update')"
                    class="flex space-x-2"
                  >
                    <button
                      @click="approvePermission(request.id)"
                      class="p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300"
                    >
                      <i class="fas fa-check"></i>
                    </button>
                    <button
                      @click="rejectPermission(request.id)"
                      class="p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- Audit Log Modal -->
    <div
      x-show="showAuditLog"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
      x-cloak
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-4xl p-6 animate-fade-in max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">Audit Log</h3>
          <button
            @click="showAuditLog = false"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="mb-4 flex justify-between items-center">
          <div class="relative flex-grow max-w-md">
            <input
              type="text"
              placeholder="Search audit log..."
              class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
            />
            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
          </div>
          <button
            class="ml-4 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
          >
            <i class="fas fa-download mr-2"></i>Export
          </button>
        </div>

        <div class="space-y-4">
          <template x-for="log in auditLog" :key="log.id">
            <div
              class="border border-gray-200 dark:border-gray-700 rounded-lg p-4"
            >
              <div class="flex justify-between items-start">
                <div>
                  <div class="flex items-center mb-2">
                    <h4 class="font-medium mr-3" x-text="log.userName"></h4>
                    <span
                      class="px-2 py-1 text-xs rounded-full font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"
                      x-text="log.action"
                    ></span>
                  </div>
                  <p
                    class="text-sm text-gray-600 dark:text-gray-400 mb-2"
                    x-text="log.details"
                  ></p>
                  <div
                    class="flex items-center text-xs text-gray-500 dark:text-gray-400"
                  >
                    <i class="fas fa-clock mr-1"></i>
                    <span
                      x-text="new Date(log.timestamp).toLocaleString()"
                    ></span>
                    <span class="mx-2">â€¢</span>
                    <i class="fas fa-network-wired mr-1"></i>
                    <span x-text="log.ipAddress"></span>
                  </div>
                </div>
                <div class="text-xs text-gray-500 dark:text-gray-400">
                  <span x-text="log.target"></span>
                </div>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
      // Initialize Cesium
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize Cesium viewer
        const viewer = new Cesium.Viewer("cesiumContainer", {
          terrainProvider: Cesium.createWorldTerrain(),
          homeButton: false,
          sceneModePicker: false,
          baseLayerPicker: false,
          navigationHelpButton: false,
          animation: false,
          timeline: false,
          fullscreenButton: false,
          vrButton: false,
        });

        // Set initial view to Indonesia
        viewer.camera.setView({
          destination: Cesium.Cartesian3.fromDegrees(
            106.8456,
            -6.2088,
            15000000
          ),
        });

        // Add some sample entities (sites)
        const sites = [
          { name: "JKT-01", lon: 106.8456, lat: -6.2088 },
          { name: "BDG-01", lon: 107.6191, lat: -6.9175 },
          { name: "SMG-01", lon: 110.4167, lat: -6.9667 },
          { name: "SBY-01", lon: 112.7521, lat: -7.2575 },
        ];

        sites.forEach((site) => {
          viewer.entities.add({
            name: site.name,
            position: Cesium.Cartesian3.fromDegrees(site.lon, site.lat),
            point: {
              pixelSize: 10,
              color: Cesium.Color.RED,
              outlineColor: Cesium.Color.WHITE,
              outlineWidth: 2,
            },
            label: {
              text: site.name,
              font: "14pt sans-serif",
              style: Cesium.LabelStyle.FILL_AND_OUTLINE,
              outlineWidth: 2,
              verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
              pixelOffset: new Cesium.Cartesian2(0, -9),
            },
          });
        });

        // Add sample links
        const links = [
          { from: "JKT-01", to: "BDG-01" },
          { from: "BDG-01", to: "SMG-01" },
          { from: "SMG-01", to: "SBY-01" },
        ];

        links.forEach((link) => {
          const fromSite = sites.find((s) => s.name === link.from);
          const toSite = sites.find((s) => s.name === link.to);

          viewer.entities.add({
            polyline: {
              positions: Cesium.Cartesian3.fromDegreesArray([
                fromSite.lon,
                fromSite.lat,
                toSite.lon,
                toSite.lat,
              ]),
              width: 2,
              material: Cesium.Color.YELLOW,
              clampToGround: true,
            },
          });
        });

        // Populate link select with dummy data
        const linkSelect = document.getElementById("linkSelect");
        const dummyLinks = [
          "JKT-01 to BDG-01",
          "BDG-01 to SMG-01",
          "SMG-01 to SBY-01",
          "JKT-01 to SMG-01",
          "BDG-01 to SBY-01",
        ];

        // Clear existing options
        linkSelect.innerHTML = "";

        // Add default option
        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "Select a link";
        linkSelect.appendChild(defaultOption);

        // Add link options
        dummyLinks.forEach((link) => {
          const option = document.createElement("option");
          option.value = link;
          option.textContent = link;
          linkSelect.appendChild(option);
        });

        // Initialize Charts
        const rslCtx = document.getElementById("rslChart").getContext("2d");
        const rslChart = new Chart(rslCtx, {
          type: "line",
          data: {
            labels: ["00:00", "04:00", "08:00", "12:00", "16:00", "20:00"],
            datasets: [
              {
                label: "RSL (dBm)",
                data: [-35, -36, -37, -35, -34, -36],
                borderColor: "#3b82f6",
                backgroundColor: "rgba(59, 130, 246, 0.1)",
                tension: 0.4,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false,
              },
            },
            scales: {
              y: {
                beginAtZero: false,
              },
            },
          },
        });

        // Tab switching functionality
        const tabLinks = document.querySelectorAll("[data-tab]");
        const tabPanes = document.querySelectorAll(".tab-pane");

        tabLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            const tabId = this.getAttribute("data-tab");

            // Update active tab link
            tabLinks.forEach((l) => {
              l.classList.remove(
                "border-primary-600",
                "text-primary-600",
                "dark:text-primary-400"
              );
              l.classList.add(
                "border-transparent",
                "text-gray-500",
                "hover:text-gray-700",
                "dark:text-gray-400",
                "dark:hover:text-gray-300",
                "hover:border-gray-300",
                "dark:hover:border-gray-600"
              );
            });

            this.classList.remove(
              "border-transparent",
              "text-gray-500",
              "hover:text-gray-700",
              "dark:text-gray-400",
              "dark:hover:text-gray-300",
              "hover:border-gray-300",
              "dark:hover:border-gray-600"
            );
            this.classList.add(
              "border-primary-600",
              "text-primary-600",
              "dark:text-primary-400"
            );

            // Show active tab pane
            tabPanes.forEach((pane) => {
              pane.classList.add("hidden");
            });

            document.getElementById(tabId).classList.remove("hidden");

            // Initialize chart if needed
            if (tabId === "util-tab" && !window.utilChartInitialized) {
              const utilCtx = document
                .getElementById("utilChart")
                .getContext("2d");
              const utilChart = new Chart(utilCtx, {
                type: "line",
                data: {
                  labels: [
                    "00:00",
                    "04:00",
                    "08:00",
                    "12:00",
                    "16:00",
                    "20:00",
                  ],
                  datasets: [
                    {
                      label: "Utilization (%)",
                      data: [45, 52, 48, 65, 70, 60],
                      borderColor: "#f59e0b",
                      backgroundColor: "rgba(245, 158, 11, 0.1)",
                      tension: 0.4,
                      fill: true,
                    },
                  ],
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                    legend: {
                      display: false,
                    },
                  },
                  scales: {
                    y: {
                      beginAtZero: true,
                      max: 100,
                    },
                  },
                },
              });
              window.utilChartInitialized = true;
            }

            if (
              tabId === "throughput-tab" &&
              !window.throughputChartInitialized
            ) {
              const throughputCtx = document
                .getElementById("throughputChart")
                .getContext("2d");
              const throughputChart = new Chart(throughputCtx, {
                type: "line",
                data: {
                  labels: [
                    "00:00",
                    "04:00",
                    "08:00",
                    "12:00",
                    "16:00",
                    "20:00",
                  ],
                  datasets: [
                    {
                      label: "Throughput (Mbps)",
                      data: [120, 135, 140, 155, 160, 145],
                      borderColor: "#10b981",
                      backgroundColor: "rgba(16, 185, 129, 0.1)",
                      tension: 0.4,
                      fill: true,
                    },
                  ],
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                    legend: {
                      display: false,
                    },
                  },
                  scales: {
                    y: {
                      beginAtZero: true,
                    },
                  },
                },
              });
              window.throughputChartInitialized = true;
            }

            if (tabId === "errors-tab" && !window.errorsChartInitialized) {
              const errorsCtx = document
                .getElementById("errorsChart")
                .getContext("2d");
              const errorsChart = new Chart(errorsCtx, {
                type: "bar",
                data: {
                  labels: [
                    "00:00",
                    "04:00",
                    "08:00",
                    "12:00",
                    "16:00",
                    "20:00",
                  ],
                  datasets: [
                    {
                      label: "Errors",
                      data: [2, 5, 3, 8, 12, 7],
                      backgroundColor: "#ef4444",
                    },
                  ],
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                    legend: {
                      display: false,
                    },
                  },
                  scales: {
                    y: {
                      beginAtZero: true,
                    },
                  },
                },
              });
              window.errorsChartInitialized = true;
            }
          });
        });

        // Form submission handlers
        document
          .getElementById("uploadForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            const fileInput = this.querySelector('input[type="file"]');
            const file = fileInput.files[0];

            if (!file) {
              alert("Please select a file");
              return;
            }

            // Check file size (10MB limit)
            if (file.size > 10 * 1024 * 1024) {
              alert("File size must be less than 10MB");
              return;
            }

            // Check file type
            const validTypes = [
              "application/vnd.google-earth.kml+xml",
              "application/vnd.google-earth.kmz",
            ];
            if (
              !validTypes.includes(file.type) &&
              !file.name.match(/\.(kml|kmz)$/i)
            ) {
              alert("Only KML/KMZ files are allowed");
              return;
            }

            // Simulate upload with progress
            const progressBar = document.createElement("div");
            progressBar.className =
              "w-full bg-gray-200 rounded-full h-2.5 mt-2";
            progressBar.innerHTML =
              '<div class="bg-primary-600 h-2.5 rounded-full" style="width: 0%"></div>';

            const progressText = document.createElement("p");
            progressText.className =
              "text-sm text-gray-500 dark:text-gray-400 mt-1";
            progressText.textContent = "Uploading: 0%";

            fileInput.parentNode.appendChild(progressBar);
            fileInput.parentNode.appendChild(progressText);

            let progress = 0;
            const interval = setInterval(() => {
              progress += 10;
              progressBar.querySelector("div").style.width = progress + "%";
              progressText.textContent = `Uploading: ${progress}%`;

              if (progress >= 100) {
                clearInterval(interval);

                // Show success notification
                const notification = document
                  .querySelector("[x-data]")
                  .__x.$data.showNotification(
                    "File uploaded successfully!",
                    "success"
                  );

                // Remove progress elements
                setTimeout(() => {
                  progressBar.remove();
                  progressText.remove();
                }, 2000);

                // Reset form
                this.reset();
              }
            }, 200);
          });

        document
          .getElementById("dataForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            const linkSelect = document.getElementById("linkSelect");
            const startDate = document.getElementById("startDate");
            const endDate = document.getElementById("endDate");

            // Simple validation
            if (!linkSelect.value) {
              alert("Please select a link");
              return;
            }

            if (!startDate.value || !endDate.value) {
              alert("Please select both start and end dates");
              return;
            }

            if (new Date(startDate.value) > new Date(endDate.value)) {
              alert("Start date must be before end date");
              return;
            }

            // Show success notification
            const notification = document
              .querySelector("[x-data]")
              .__x.$data.showNotification(
                "Data filtered successfully!",
                "success"
              );

            // Update metrics with animation
            animateValue("rslMax", 0, -35, 1000);
            animateValue("rslMin", 0, -45, 1000);
            animateValue("throughputMax", 0, 160, 1000);
            animateValue("utilMax", 0, 75, 1000);
          });

        // Function to animate value changes
        function animateValue(id, start, end, duration) {
          const obj = document.getElementById(id);
          const range = end - start;
          const minTimer = 50;
          let stepTime = Math.abs(Math.floor(duration / range));
          stepTime = Math.max(stepTime, minTimer);
          const startTime = new Date().getTime();
          const endTime = startTime + duration;
          let timer;

          function run() {
            const now = new Date().getTime();
            const remaining = Math.max((endTime - now) / duration, 0);
            const value = Math.round(end - remaining * range);
            obj.innerHTML = value;
            if (value == end) {
              clearInterval(timer);
            }
          }

          timer = setInterval(run, stepTime);
          run();
        }

        // Handle sidebar collapse on mobile
        function handleSidebarCollapse() {
          const sidebar = document.querySelector(".sidebar");
          const mainContent = document.querySelector(".main-content");
          const sidebarCollapsed =
            localStorage.getItem("sidebarCollapsed") === "true";

          if (window.innerWidth < 768) {
            sidebar.classList.add("collapsed");
            mainContent.classList.add("expanded");
          } else {
            if (sidebarCollapsed) {
              sidebar.classList.add("collapsed");
              mainContent.classList.add("expanded");
            } else {
              sidebar.classList.remove("collapsed");
              mainContent.classList.remove("expanded");
            }
          }
        }

        // Add resize event listener
        window.addEventListener("resize", handleSidebarCollapse);
        // Call on load
        handleSidebarCollapse();

        // Auto-hide notifications after 3 seconds
        function hideNotifications() {
          const notifications = document.querySelectorAll(".notification");
          notifications.forEach((notification) => {
            setTimeout(() => {
              notification.style.opacity = "0";
              setTimeout(() => {
                notification.remove();
              }, 300);
            }, 3000);
          });
        }

        // Call when new notification is added
        const observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.addedNodes.length) {
              hideNotifications();
            }
          });
        });

        observer.observe(document.querySelector(".fixed.top-4.right-4"), {
          childList: true,
        });
      });
    </script>
  </body>
</html>
